<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title></title>
      <link href="/2023/07/27/newgalaxy/"/>
      <url>/2023/07/27/newgalaxy/</url>
      
        <content type="html"><![CDATA[<p><img src="https://niubi-1316733611.cos.ap-beijing.myqcloud.com/640.jpg"></p><h6 id="æœ¬å¹¿å‘Šä¸­çš„äº§å“å›¾ç‰‡ä»¥åŠå‹å·ã€æ•°æ®ã€åŠŸèƒ½ã€è§„æ ¼å‚æ•°ç­‰ä»…ä¾›å‚è€ƒï¼Œä¸‰æ˜Ÿæœ‰å¯èƒ½å¯¹ä¸Šè¿°å†…å®¹è¿›è¡Œæ”¹è¿›ï¼Œå…·ä½“ä¿¡æ¯è¯·å‚ç…§äº§å“å®ç‰©ã€äº§å“è¯´æ˜ä¹¦æˆ–ä¸‰æ˜Ÿå®˜ç½‘ï¼ˆ-www-samsung-com-cn-ã€‚é™¤éç»ç‰¹æ®Šè¯´æ˜ï¼Œæœ¬å¹¿å‘Šä¸­æ‰€æ¶‰åŠçš„æ•°æ®å‡ä¸ºä¸‰æ˜Ÿå†…éƒ¨æµ‹è¯•ç»“æœï¼Œæ¶‰åŠçš„å¯¹æ¯”å‡ä¸ºä¸ä¸‰æ˜Ÿäº§å“ç›¸æ¯”è¾ƒã€‚"><a href="#æœ¬å¹¿å‘Šä¸­çš„äº§å“å›¾ç‰‡ä»¥åŠå‹å·ã€æ•°æ®ã€åŠŸèƒ½ã€è§„æ ¼å‚æ•°ç­‰ä»…ä¾›å‚è€ƒï¼Œä¸‰æ˜Ÿæœ‰å¯èƒ½å¯¹ä¸Šè¿°å†…å®¹è¿›è¡Œæ”¹è¿›ï¼Œå…·ä½“ä¿¡æ¯è¯·å‚ç…§äº§å“å®ç‰©ã€äº§å“è¯´æ˜ä¹¦æˆ–ä¸‰æ˜Ÿå®˜ç½‘ï¼ˆ-www-samsung-com-cn-ã€‚é™¤éç»ç‰¹æ®Šè¯´æ˜ï¼Œæœ¬å¹¿å‘Šä¸­æ‰€æ¶‰åŠçš„æ•°æ®å‡ä¸ºä¸‰æ˜Ÿå†…éƒ¨æµ‹è¯•ç»“æœï¼Œæ¶‰åŠçš„å¯¹æ¯”å‡ä¸ºä¸ä¸‰æ˜Ÿäº§å“ç›¸æ¯”è¾ƒã€‚" class="headerlink" title="*æœ¬å¹¿å‘Šä¸­çš„äº§å“å›¾ç‰‡ä»¥åŠå‹å·ã€æ•°æ®ã€åŠŸèƒ½ã€è§„æ ¼å‚æ•°ç­‰ä»…ä¾›å‚è€ƒï¼Œä¸‰æ˜Ÿæœ‰å¯èƒ½å¯¹ä¸Šè¿°å†…å®¹è¿›è¡Œæ”¹è¿›ï¼Œå…·ä½“ä¿¡æ¯è¯·å‚ç…§äº§å“å®ç‰©ã€äº§å“è¯´æ˜ä¹¦æˆ–ä¸‰æ˜Ÿå®˜ç½‘ï¼ˆ www.samsung.com/cn )ã€‚é™¤éç»ç‰¹æ®Šè¯´æ˜ï¼Œæœ¬å¹¿å‘Šä¸­æ‰€æ¶‰åŠçš„æ•°æ®å‡ä¸ºä¸‰æ˜Ÿå†…éƒ¨æµ‹è¯•ç»“æœï¼Œæ¶‰åŠçš„å¯¹æ¯”å‡ä¸ºä¸ä¸‰æ˜Ÿäº§å“ç›¸æ¯”è¾ƒã€‚"></a>*æœ¬å¹¿å‘Šä¸­çš„äº§å“å›¾ç‰‡ä»¥åŠå‹å·ã€æ•°æ®ã€åŠŸèƒ½ã€è§„æ ¼å‚æ•°ç­‰ä»…ä¾›å‚è€ƒï¼Œä¸‰æ˜Ÿæœ‰å¯èƒ½å¯¹ä¸Šè¿°å†…å®¹è¿›è¡Œæ”¹è¿›ï¼Œå…·ä½“ä¿¡æ¯è¯·å‚ç…§äº§å“å®ç‰©ã€äº§å“è¯´æ˜ä¹¦æˆ–ä¸‰æ˜Ÿå®˜ç½‘ï¼ˆ <a href="http://www.samsung.com/cn">www.samsung.com/cn</a> )ã€‚é™¤éç»ç‰¹æ®Šè¯´æ˜ï¼Œæœ¬å¹¿å‘Šä¸­æ‰€æ¶‰åŠçš„æ•°æ®å‡ä¸ºä¸‰æ˜Ÿå†…éƒ¨æµ‹è¯•ç»“æœï¼Œæ¶‰åŠçš„å¯¹æ¯”å‡ä¸ºä¸ä¸‰æ˜Ÿäº§å“ç›¸æ¯”è¾ƒã€‚</h6><h6 id="å†…å®¹è½¬è½½è‡ªä¸‰æ˜ŸGALAXYç›–ä¹ä¸–å¾®åš"><a href="#å†…å®¹è½¬è½½è‡ªä¸‰æ˜ŸGALAXYç›–ä¹ä¸–å¾®åš" class="headerlink" title="*å†…å®¹è½¬è½½è‡ªä¸‰æ˜ŸGALAXYç›–ä¹ä¸–å¾®åš"></a>*å†…å®¹è½¬è½½è‡ªä¸‰æ˜ŸGALAXYç›–ä¹ä¸–å¾®åš</h6>]]></content>
      
      
      <categories>
          
          <category> ç”Ÿæ´» </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¸‰æ˜Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç›–ä¹ä¸–ç¤¾åŒºå¸–å­æ€»ç»“</title>
      <link href="/2023/07/25/galaxy/"/>
      <url>/2023/07/25/galaxy/</url>
      
        <content type="html"><![CDATA[<table interlaced="enabled" align="center">    <caption style="border-color: rgb(255, 255, 255);">        <strong><span style="font-size: 24px;">â†“â†“â†“æˆ‘çš„ç²¾åè´´â†“â†“â†“</span></strong><br>    </caption>    <tbody>        <tr class="ue-table-interlace-color-single firstRow">            <td valign="top" style="border-color: rgb(255, 255, 255);"></td>            <td valign="top" style="border-color: rgb(255, 255, 255);"></td>        </tr>        <tr class="ue-table-interlace-color-double">            <td valign="middle" style="word-break: break-all; border-width: 1px; border-style: solid; border-color: rgb(255, 255, 255);" align="center">                <p style="text-align:center">                    <a href="https://www.samsungmembers.cn/thread-2133910-368-577.html" target="_self" title="ç«‹å³å‰å¾€"><img src="http://www.samsungmembers.cn//Upload/IMAGES/24/0317/bb5bd035f3534fec8b9ee871ba7e5b51_650x0.jpeg" height="300"></a>                </p>                <p>                    <a href="https://www.samsungmembers.cn/thread-2133910-368-577.html" target="_self" title="ç«‹å³å‰å¾€"><strong>ã€æ²ˆé˜³è‰ºæœ¯æ‘„å½±ã€‘æ˜Ÿéƒ¨è½ï¼†ç¾æœ¯é¦†</strong></a><br>                </p>            </td>            <td valign="middle" style="word-break: break-all; border-width: 1px; border-style: solid; border-color: rgb(255, 255, 255);" align="center">                <p style="text-align:center">                    <a href="https://www.samsungmembers.cn/thread-2133834-368-577.html?v=1711110987177" target="_self" title="ç«‹å³å‰å¾€"><img src="http://www.samsungmembers.cn//Upload/IMAGES/24/0322/1ca9027b53334d2ebfcc8fa4f022dbf8_650x0.jpeg" height="300"></a>                </p>                <p>                    <a href="https://www.samsungmembers.cn/thread-2133834-368-577.html?v=1711110987177" target="_self" title="ç«‹å³å‰å¾€"><strong>ã€æ‹äº†æ‹ç¾æœ¯é¦†ã€‘S23U-åˆ«å¤„ç¾æœ¯é¦†</strong></a><br>                </p>            </td>        </tr>        <tr class="ue-table-interlace-color-single">            <td valign="middle" style="word-break: break-all; border-width: 1px; border-style: solid; border-color: rgb(255, 255, 255);" align="center">                <p style="text-align:center">                    <a href="https://www.samsungmembers.cn/thread-2111872-368-578.html" target="_self" title="ç«‹å³å‰å¾€"><img src="http://www.samsungmembers.cn//Upload/IMAGES/24/0303/b093c0352e154647a36aef82fd9e1aaf_650x0.jpeg" height="300"></a>                </p>                <p>                    <a href="https://www.samsungmembers.cn/thread-2111872-368-578.html" target="_self" title="ç«‹å³å‰å¾€"><strong>ã€Galaxyå°æŠ€å·§ã€‘å·§ç”¨æ—¥å¸¸ç¨‹åºä¿æŠ¤ç”µæ± </strong></a><br>                </p>            </td>            <td valign="middle" style="word-break: break-all; border-width: 1px; border-style: solid; border-color: rgb(255, 255, 255);" align="center">                <p style="text-align:center">                    <a href="https://www.samsungmembers.cn/thread-1976110-368-577.html" target="_self" title="ç«‹å³å‰å¾€"><img src="http://www.galaxyclub.cn//Upload/IMAGES/23/1126/a885568114bb4a3485e53ff9a9ad848a_650x0.jpeg" height="300"></a>                </p>                <p>                    <a href="https://www.samsungmembers.cn/thread-1976110-368-577.html" target="_self" title="ç«‹å³å‰å¾€"><strong>ã€æ´»åŠ¨å›é¡¾ã€‘FEç³»åˆ—æ–°å“å“é‰´&amp;ç”¨é¤è§‚å½±</strong></a><br>                </p>            </td>        </tr>        <tr class="ue-table-interlace-color-double">            <td valign="middle" style="word-break: break-all; border-width: 1px; border-style: solid; border-color: rgb(255, 255, 255);" align="center">                <p style="text-align:center">                    <a href="https://www.samsungmembers.cn/thread-1825525-368-577.html" target="_self" title="ç«‹å³å‰å¾€"><img src="http://www.samsungmembers.cn//Upload/IMAGES/23/0729/6e09574e87054f34b0c003a380aeccd2_650x0.jpg" height="300"></a>                </p>                <p>                    <a href="https://www.samsungmembers.cn/thread-1825525-368-577.html" target="_self" title="ç«‹å³å‰å¾€"><strong>ã€æ´»åŠ¨å›é¡¾ã€‘é¥¼å¹²çƒ˜ç„™ï¼†ä½“éªŒå»¶æ—¶æ‘„å½±</strong></a><br>                </p>            </td>            <td valign="middle" style="word-break: break-all; border-width: 1px; border-style: solid; border-color: rgb(255, 255, 255);" align="center">                <p style="text-align:center">                    <a href="https://www.samsungmembers.cn/thread-1798765-33-41.html" target="_self" title="ç«‹å³å‰å¾€"><img src="https://www.samsungmembers.cn/Content/web/img/index/logo.png"></a>                </p>                <p>                    <a href="https://www.samsungmembers.cn/thread-1798765-33-41.html" target="_self" title="ç«‹å³å‰å¾€"><strong>ã€8å‘¨å¹´ç”Ÿå¿«ã€‘å°ä¼™ä¼´ä»¬ä¸€èµ·ä¸ºç¤¾åŒºåº†ç”Ÿ</strong></a><br>                </p>            </td>        </tr>        <tr class="ue-table-interlace-color-single">            <td valign="middle" style="word-break: break-all; border-width: 1px; border-style: solid; border-color: rgb(255, 255, 255);" align="center">                <p style="text-align:center">                    <a href="https://www.samsungmembers.cn/thread-1705444-368-577.html" target="_self" title="ç«‹å³å‰å¾€"><img src="http://www.galaxyclub.cn//Upload/IMAGES/23/0422/08293c807505487faa6a8038bfebaa87_650x0.jpeg" height="300"></a>                </p>                <p>                    <a href="https://www.samsungmembers.cn/thread-1705444-368-577.html" target="_self" title="ç«‹å³å‰å¾€"><strong>ã€æ´»åŠ¨å›é¡¾ã€‘æ¸¸æµ·æ´‹ä¹å›­&amp;å¯çˆ±åŠ¨ç‰©æ‘„å½± </strong></a><br>                </p>            </td>            <td valign="middle" style="word-break: break-all; border-width: 1px; border-style: solid; border-color: rgb(255, 255, 255);" align="center">                <p style="text-align:center">                    <a href="https://www.samsungmembers.cn/thread-1675198-368-577.html" target="_self" title="ç«‹å³å‰å¾€"><img src="http://www.galaxyclub.cn//Upload/IMAGES/23/0329/c9ba9e2df0764d5eba41c12e0b704a56_650x0.jpeg" height="300"></a>                </p>                <p>                    <a href="https://www.samsungmembers.cn/thread-1675198-368-577.html" target="_self" title="ç«‹å³å‰å¾€"><strong>ã€æ´»åŠ¨å›é¡¾ã€‘S23æ‘„å½±ä½“éªŒ&amp;è¾½å®çœåšç‰©é¦†ä¸€æ—¥æ¸¸</strong></a><br>                </p>            </td>        </tr>        <tr class="ue-table-interlace-color-double">            <td valign="middle" style="word-break: break-all; border-width: 1px; border-style: solid; border-color: rgb(255, 255, 255);" align="center">                <p style="text-align:center">                    <a href="https://www.samsungmembers.cn/thread-1666504-368-577.html" target="_self" title="ç«‹å³å‰å¾€"><img src="http://www.galaxyclub.cn//Upload/IMAGES/23/0322/35c113686e7b4a2c9eb1ff3efae6b843_650x0.jpeg" height="300"></a>                </p>                <p>                    <a href="https://www.samsungmembers.cn/thread-1666504-368-577.html" target="_self" title="ç«‹å³å‰å¾€"><strong>ã€æ´»åŠ¨å›é¡¾ã€‘S23æ¸¸æˆæ€§èƒ½ä½“éªŒï¼†å’–å•¡ç®€é¤</strong></a><br>                </p>            </td>            <td valign="middle" style="word-break: break-all; border-width: 1px; border-style: solid; border-color: rgb(255, 255, 255);" align="center">                <p style="text-align:center">                    <a href="https://www.samsungmembers.cn/thread-1274538-33-38.html" target="_self" title="ç«‹å³å‰å¾€"><img src="http://www.galaxyclub.cn//Upload/IMAGES/22/0208/82e60f7fed9149dc8ab726c3d4d3d118_650x0.jpeg" height="300"></a>                </p>                <p>                    <a href="https://www.samsungmembers.cn/thread-1274538-33-38.html" target="_self" title="ç«‹å³å‰å¾€"><strong>ã€æ–°å¹´æ°”æ°›ç»„ã€‘è™è™ç”Ÿå¨</strong></a><br>                </p>            </td>        </tr>        <tr class="ue-table-interlace-color-single">            <td valign="middle" style="word-break: break-all; border-width: 1px; border-style: solid; border-color: rgb(255, 255, 255);" align="center">                <p style="text-align:center">                    <a href="https://www.samsungmembers.cn/thread-1274534-33-41.html" target="_self" title="ç«‹å³å‰å¾€"><img src="http://www.galaxyclub.cn//Upload/IMAGES/22/0208/aff5c96eaf914f3aa59ede7e14d4d576_650x0.jpeg" height="300"></a>                </p>                <p>                    <a href="https://www.samsungmembers.cn/thread-1274534-33-41.html" target="_self" title="ç«‹å³å‰å¾€"><strong>ã€æ–°å¹´æ—¥å¸¸åˆ†äº«ã€‘å¹´å¤œé¥­çš„å¹•å</strong></a><br>                </p>            </td>            <td valign="middle" style="word-break: break-all; border-width: 1px; border-style: solid; border-color: rgb(255, 255, 255);" align="center">                <p style="text-align:center">                    <a href="https://www.samsungmembers.cn/thread-1274532-329-414.html" target="_self" title="ç«‹å³å‰å¾€"><img src="http://www.galaxyclub.cn//Upload/IMAGES/22/0208/9b0004b302b44dd9a1b86e7ba03ab389_650x0.jpeg" height="300"></a>                </p>                <p>                    <a href="https://www.samsungmembers.cn/thread-1274532-329-414.html" target="_self" title="ç«‹å³å‰å¾€"><strong>ã€æ˜¥èŠ‚ç¾é£Ÿã€‘å¼€å¼€å¿ƒå¿ƒè¿‡å¤§å¹´</strong></a><br>                </p>            </td>        </tr>        <tr class="ue-table-interlace-color-double">            <td valign="middle" style="word-break: break-all; border-width: 1px; border-style: solid; border-color: rgb(255, 255, 255);" align="center">                <p style="text-align:center">                    <a href="https://www.samsungmembers.cn/thread-1227193-368-577.html" target="_self" title="ç«‹å³å‰å¾€"><img src="https://www.samsungmembers.cn/Content/web/img/index/logo.png"></a>                </p>                <p>                    <a href="https://www.samsungmembers.cn/thread-1227193-368-577.html" target="_self" title="ç«‹å³å‰å¾€"><strong>ã€å†è§2021ã€‘ä¿æŒçƒ­çˆ±ï¼Œå…±èµ´å±±æµ·ã€‚</strong></a><br>                </p>            </td>            <td valign="middle" style="word-break: break-all; border-width: 1px; border-style: solid; border-color: rgb(255, 255, 255);" align="center">                <p style="text-align:center">                    <a href="https://www.samsungmembers.cn/thread-1209368-368-577.html" target="_self" title="ç«‹å³å‰å¾€"><img src="http://www.galaxyclub.cn//Upload/IMAGES/21/1101/a3d483e61da444ec9409aafab5da69b6_650x0.jpg" height="300"></a>                </p>                <p>                    <a href="https://www.samsungmembers.cn/thread-1209368-368-577.html" target="_self" title="ç«‹å³å‰å¾€"><strong>ã€ç®€å•çš„é»‘ç™½ç°ã€‘é»‘ç™½æ‘„å½±çš„é­…åŠ›</strong></a><br>                </p>            </td>        </tr>    </tbody></table><table interlaced="enabled" align="center">    <caption style="border-color: rgb(255, 255, 255);">        <strong><span style="font-size: 24px;">â†“â†“â†“é‚£äº›å¹´æˆ‘ä¸Šè¿‡çš„é¦–é¡µâ†“â†“â†“</span></strong><br>    </caption>    <tbody>        <tr class="ue-table-interlace-color-single firstRow">            <td valign="middle" style="word-break: break-all; border-width: 1px; border-style: solid; border-color: rgb(255, 255, 255);" align="center">                <p style="text-align:center">                    <a href="https://www.samsungmembers.cn/thread-2125444-368-577.html" target="_self" title="ç«‹å³å‰å¾€"><img src="http://www.samsungmembers.cn//Upload/IMAGES/24/0309/7ca65828a45a45839b0a05d44bb530d0_650x0.jpeg" height="300"></a>                </p>                <p>                    <a href="https://www.samsungmembers.cn/thread-2125444-368-577.html" target="_self" title="ç«‹å³å‰å¾€"><strong>ã€å–œè¿ä½³èŠ‚ã€‘æ²ˆé˜³å°å—å¤©ä¸»æ•™å ‚</strong></a><br>                </p>            </td>            <td valign="middle" style="word-break: break-all; border-width: 1px; border-style: solid; border-color: rgb(255, 255, 255);" align="center">                <p style="text-align:center">                    <a href="https://www.samsungmembers.cn/thread-2122056-368-577.html" target="_self" title="ç«‹å³å‰å¾€"><img src="http://www.samsungmembers.cn//Upload/IMAGES/24/0309/f167be61cec04c48ada5ba6616553149_650x0.jpeg" height="300"></a>                </p>                <p>                    <a href="https://www.samsungmembers.cn/thread-2122056-368-577.html" target="_self" title="ç«‹å³å‰å¾€"><strong>ã€å–œè¿ä½³èŠ‚ã€‘s23uæ²ˆé˜³å½©ç”µå¡”</strong></a><br>                </p>            </td>        </tr>        <tr class="ue-table-interlace-color-double">            <td valign="middle" style="word-break: break-all; border-width: 1px; border-style: solid; border-color: rgb(255, 255, 255);" align="center">                <p style="text-align:center">                    <a href="https://www.samsungmembers.cn/thread-2122050-368-577.html" target="_self" title="ç«‹å³å‰å¾€"><img src="http://www.samsungmembers.cn//Upload/IMAGES/24/0309/69bf0ffa5e0d476d8b7b79ebe6103e9a_650x0.jpeg" height="300"></a>                </p>                <p>                    <a href="https://www.samsungmembers.cn/thread-2122050-368-577.html" target="_self" title="ç«‹å³å‰å¾€"><strong>ã€æ–°å¹´çš„æ›™å…‰ã€‘æ˜¥å¤©çš„èŠ±èŠ±é±¼é±¼</strong></a><br>                </p>            </td>            <td valign="middle" style="word-break: break-all; border-width: 1px; border-style: solid; border-color: rgb(255, 255, 255);" align="center">                <p style="text-align:center">                    <a href="https://www.samsungmembers.cn/thread-2120305-31-287.html" target="_self" title="ç«‹å³å‰å¾€"><img src="http://www.samsungmembers.cn//upload/images/24/0306/9d895f6f2ff54ed9b35e6629d80848e3_650x0.jpeg" height="300"></a>                </p>                <p>                    <a href="https://www.samsungmembers.cn/thread-2120305-31-287.html" target="_self" title="ç«‹å³å‰å¾€"><strong>ã€é›•åˆ»æ—¶å…‰ã€‘æ²ˆé˜³-äº”é‡Œæ²³CBD</strong></a><br>                </p>            </td>        </tr>        <tr class="ue-table-interlace-color-single">            <td valign="middle" style="word-break: break-all; border-width: 1px; border-style: solid; border-color: rgb(255, 255, 255);" align="center">                <p style="text-align:center">                    <img src="http://www.samsungmembers.cn//upload/images/24/0306/04afba53d3b84df995f21b529c7df581_650x0.jpeg" height="300">                </p>                <p>                    <a href="https://www.samsungmembers.cn/thread-2117715-31-287.html" target="_self" title="ç«‹å³å‰å¾€"><strong>ã€é›•åˆ»æ—¶å…‰ã€‘S23UğŸ“·æ²ˆé˜³â€œå¤§é’»çŸ³â€</strong></a><br>                </p>            </td>            <td valign="middle" style="word-break: break-all; border-width: 1px; border-style: solid; border-color: rgb(255, 255, 255);" align="center">                <p style="text-align:center">                    <a href="https://www.samsungmembers.cn/thread-2007669-31-287.html" target="_self" title="ç«‹å³å‰å¾€"><img src="http://www.galaxyclub.cn//upload/images/23/1215/bf6a9287e1184aaab810964c5ff3b825_650x0.jpeg" height="300"></a>                </p>                <p>                    <a href="https://www.samsungmembers.cn/thread-2007669-31-287.html" target="_self" title="ç«‹å³å‰å¾€"><strong>ã€éšå¤„é£æ™¯ã€‘éšå¤„é£æ™¯ </strong></a><br>                </p>            </td>        </tr>        <tr class="ue-table-interlace-color-double">            <td valign="middle" style="word-break: break-all; border-width: 1px; border-style: solid; border-color: rgb(255, 255, 255);" align="center">                <p style="text-align:center">                    <a href="https://www.samsungmembers.cn/thread-1235847-368-577.html" target="_self" title="ç«‹å³å‰å¾€"><img src="http://www.galaxyclub.cn//Upload/IMAGES/21/1214/89259f6adb374d2cbb2fcc6a2226a5d0_650x0.jpeg" height="300"></a>                </p>                <p>                    <a href="https://www.samsungmembers.cn/thread-1235847-368-577.html" target="_self" title="ç«‹å³å‰å¾€"><strong>ã€æˆ‘çš„æ”¶è—ã€‘æˆ‘æœ€æœ€æœ€å–œæ¬¢çš„å®ƒï¼ï¼ï¼</strong></a><br>                </p>            </td>            <td valign="middle" style="word-break: break-all; border-width: 1px; border-style: solid; border-color: rgb(255, 255, 255);" align="center">                <p style="text-align:center">                    <a href="https://www.samsungmembers.cn/thread-1205832-368-577.html" target="_self" title="ç«‹å³å‰å¾€"><img src="http://www.galaxyclub.cn//Upload/IMAGES/21/1024/7e8d25299f8347f190831426a4cc5049_650x0.jpg" height="300"></a>                </p>                <p>                    <a href="https://www.samsungmembers.cn/thread-1205832-368-577.html" target="_self" title="ç«‹å³å‰å¾€"><strong>ã€æ´»åŠ¨å›é¡¾ã€‘ä¸‰æ˜ŸæŠ˜å æ‰‹æœºå“é‰´ä¼š</strong></a><br>                </p>            </td>        </tr>        <tr class="ue-table-interlace-color-single">            <td valign="middle" style="word-break: break-all; border-width: 1px; border-style: solid; border-color: rgb(255, 255, 255);" align="center">                <p style="text-align:center">                    <a href="https://www.samsungmembers.cn/thread-1224316-31-287.html" target="_self" title="ç«‹å³å‰å¾€"><img src="http://www.galaxyclub.cn//upload/images/21/1201/69eb4ab772e24b8e86e6fda0b530f45d_650x0.jpeg" height="300"></a>                </p>                <p>                    <a href="https://www.samsungmembers.cn/thread-1224316-31-287.html" target="_self" title="ç«‹å³å‰å¾€"><strong>ã€éšæ‹ã€‘å¥½ä¹…ä¸è§</strong></a><br>                </p>            </td>            <td valign="middle" style="word-break: break-all; border-width: 1px; border-style: solid; border-color: rgb(255, 255, 255);" align="center">                <p style="text-align:center">                    <a href="https://www.samsungmembers.cn/thread-1206367-31-284.html" target="_self" title="ç«‹å³å‰å¾€"><img src="http://www.galaxyclub.cn//upload/images/21/1025/f0fb6c2562354aa4b2192a821fd865d2_650x0.jpg" height="300"></a>                </p>                <p>                    <a href="https://www.samsungmembers.cn/thread-1206367-31-284.html" target="_self" title="ç«‹å³å‰å¾€"><strong>ã€å‘æ—¥è‘µç”°ğŸŒ»ã€‘æ²ˆé˜³æ²ˆåŒ—è’²æ²³è·¯è¶…å¤§çš„å‘æ—¥è‘µç”° </strong></a><br>                </p>            </td>        </tr>    </tbody></table>]]></content>
      
      
      <categories>
          
          <category> ç”Ÿæ´» </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç›–ä¹ä¸–ç¤¾åŒº </tag>
            
            <tag> ä¸‰æ˜Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŸºäºMindSporeçš„FCNå›¾åƒè¯­ä¹‰åˆ†å‰²</title>
      <link href="/2023/07/25/mindspore-fcn8s/"/>
      <url>/2023/07/25/mindspore-fcn8s/</url>
      
        <content type="html"><![CDATA[<h1 id="FCNå›¾åƒè¯­ä¹‰åˆ†å‰²"><a href="#FCNå›¾åƒè¯­ä¹‰åˆ†å‰²" class="headerlink" title="FCNå›¾åƒè¯­ä¹‰åˆ†å‰²"></a>FCNå›¾åƒè¯­ä¹‰åˆ†å‰²</h1><p>å…¨å·ç§¯ç½‘ç»œï¼ˆFully Convolutional Networksï¼ŒFCNï¼‰æ˜¯UC Berkeleyçš„Jonathan Longç­‰äººäº2015å¹´åœ¨Fully Convolutional Networks for Semantic Segmentationä¸€æ–‡ä¸­æå‡ºçš„ç”¨äºå›¾åƒè¯­ä¹‰åˆ†å‰²çš„ä¸€ç§æ¡†æ¶ã€‚</p><p>FCNæ˜¯é¦–ä¸ªç«¯åˆ°ç«¯ï¼ˆend to endï¼‰è¿›è¡Œåƒç´ çº§ï¼ˆpixel levelï¼‰é¢„æµ‹çš„å…¨å·ç§¯ç½‘ç»œã€‚</p><p><img src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/r2.0/tutorials/application/source_zh_cn/cv/images/fcn_1.png" alt="fcn-1"></p><h2 id="è¯­ä¹‰åˆ†å‰²"><a href="#è¯­ä¹‰åˆ†å‰²" class="headerlink" title="è¯­ä¹‰åˆ†å‰²"></a>è¯­ä¹‰åˆ†å‰²</h2><p>åœ¨å…·ä½“ä»‹ç»FCNä¹‹å‰ï¼Œé¦–å…ˆä»‹ç»ä½•ä¸ºè¯­ä¹‰åˆ†å‰²ï¼š</p><p>å›¾åƒè¯­ä¹‰åˆ†å‰²ï¼ˆsemantic segmentationï¼‰æ˜¯å›¾åƒå¤„ç†å’Œæœºå™¨è§†è§‰æŠ€æœ¯ä¸­å…³äºå›¾åƒç†è§£çš„é‡è¦ä¸€ç¯ï¼ŒAIé¢†åŸŸä¸­ä¸€ä¸ªé‡è¦åˆ†æ”¯ï¼Œå¸¸è¢«åº”ç”¨äºäººè„¸è¯†åˆ«ã€ç‰©ä½“æ£€æµ‹ã€åŒ»å­¦å½±åƒã€å«æ˜Ÿå›¾åƒåˆ†æã€è‡ªåŠ¨é©¾é©¶æ„ŸçŸ¥ç­‰é¢†åŸŸã€‚</p><p>è¯­ä¹‰åˆ†å‰²çš„ç›®çš„æ˜¯å¯¹å›¾åƒä¸­æ¯ä¸ªåƒç´ ç‚¹è¿›è¡Œåˆ†ç±»ã€‚ä¸æ™®é€šçš„åˆ†ç±»ä»»åŠ¡åªè¾“å‡ºæŸä¸ªç±»åˆ«ä¸åŒï¼Œè¯­ä¹‰åˆ†å‰²ä»»åŠ¡è¾“å‡ºä¸è¾“å…¥å¤§å°ç›¸åŒçš„å›¾åƒï¼Œè¾“å‡ºå›¾åƒçš„æ¯ä¸ªåƒç´ å¯¹åº”äº†è¾“å…¥å›¾åƒæ¯ä¸ªåƒç´ çš„ç±»åˆ«ã€‚è¯­ä¹‰åœ¨å›¾åƒé¢†åŸŸæŒ‡çš„æ˜¯å›¾åƒçš„å†…å®¹ï¼Œå¯¹å›¾ç‰‡æ„æ€çš„ç†è§£ï¼Œä¸‹å›¾æ˜¯ä¸€äº›è¯­ä¹‰åˆ†å‰²çš„å®ä¾‹ï¼š</p><p><img src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/r2.0/tutorials/application/source_zh_cn/cv/images/fcn_2.png" alt="fcn-2"></p><h2 id="æ¨¡å‹ç®€ä»‹"><a href="#æ¨¡å‹ç®€ä»‹" class="headerlink" title="æ¨¡å‹ç®€ä»‹"></a>æ¨¡å‹ç®€ä»‹</h2><p>FCNä¸»è¦ç”¨äºå›¾åƒåˆ†å‰²é¢†åŸŸï¼Œæ˜¯ä¸€ç§ç«¯åˆ°ç«¯çš„åˆ†å‰²æ–¹æ³•ï¼Œæ˜¯æ·±åº¦å­¦ä¹ åº”ç”¨åœ¨å›¾åƒè¯­ä¹‰åˆ†å‰²çš„å¼€å±±ä¹‹ä½œã€‚é€šè¿‡è¿›è¡Œåƒç´ çº§çš„é¢„æµ‹ç›´æ¥å¾—å‡ºä¸åŸå›¾å¤§å°ç›¸ç­‰çš„label mapã€‚å› FCNä¸¢å¼ƒå…¨è¿æ¥å±‚æ›¿æ¢ä¸ºå…¨å·ç§¯å±‚ï¼Œç½‘ç»œæ‰€æœ‰å±‚å‡ä¸ºå·ç§¯å±‚ï¼Œæ•…ç§°ä¸ºå…¨å·ç§¯ç½‘ç»œã€‚</p><p>å…¨å·ç§¯ç¥ç»ç½‘ç»œä¸»è¦ä½¿ç”¨ä»¥ä¸‹ä¸‰ç§æŠ€æœ¯ï¼š</p><ol><li><p>å·ç§¯åŒ–ï¼ˆConvolutionalï¼‰</p><p> ä½¿ç”¨VGG-16ä½œä¸ºFCNçš„backboneã€‚VGG-16çš„è¾“å…¥ä¸º224*224çš„RGBå›¾åƒï¼Œè¾“å‡ºä¸º1000ä¸ªé¢„æµ‹å€¼ã€‚VGG-16åªèƒ½æ¥å—å›ºå®šå¤§å°çš„è¾“å…¥ï¼Œä¸¢å¼ƒäº†ç©ºé—´åæ ‡ï¼Œäº§ç”Ÿéç©ºé—´è¾“å‡ºã€‚VGG-16ä¸­å…±æœ‰ä¸‰ä¸ªå…¨è¿æ¥å±‚ï¼Œå…¨è¿æ¥å±‚ä¹Ÿå¯è§†ä¸ºå¸¦æœ‰è¦†ç›–æ•´ä¸ªåŒºåŸŸçš„å·ç§¯ã€‚å°†å…¨è¿æ¥å±‚è½¬æ¢ä¸ºå·ç§¯å±‚èƒ½ä½¿ç½‘ç»œè¾“å‡ºç”±ä¸€ç»´éç©ºé—´è¾“å‡ºå˜ä¸ºäºŒç»´çŸ©é˜µï¼Œåˆ©ç”¨è¾“å‡ºèƒ½ç”Ÿæˆè¾“å…¥å›¾ç‰‡æ˜ å°„çš„heatmapã€‚</p><p><img src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/r2.0/tutorials/application/source_zh_cn/cv/images/fcn_3.png" alt="fcn-3"></p></li><li><p>ä¸Šé‡‡æ ·ï¼ˆUpsampleï¼‰</p><p> åœ¨å·ç§¯è¿‡ç¨‹çš„å·ç§¯æ“ä½œå’Œæ± åŒ–æ“ä½œä¼šä½¿å¾—ç‰¹å¾å›¾çš„å°ºå¯¸å˜å°ï¼Œä¸ºå¾—åˆ°åŸå›¾çš„å¤§å°çš„ç¨ å¯†å›¾åƒé¢„æµ‹ï¼Œéœ€è¦å¯¹å¾—åˆ°çš„ç‰¹å¾å›¾è¿›è¡Œä¸Šé‡‡æ ·æ“ä½œã€‚ä½¿ç”¨åŒçº¿æ€§æ’å€¼çš„å‚æ•°æ¥åˆå§‹åŒ–ä¸Šé‡‡æ ·é€†å·ç§¯çš„å‚æ•°ï¼Œåé€šè¿‡åå‘ä¼ æ’­æ¥å­¦ä¹ éçº¿æ€§ä¸Šé‡‡æ ·ã€‚åœ¨ç½‘ç»œä¸­æ‰§è¡Œä¸Šé‡‡æ ·ï¼Œä»¥é€šè¿‡åƒç´ æŸå¤±çš„åå‘ä¼ æ’­è¿›è¡Œç«¯åˆ°ç«¯çš„å­¦ä¹ ã€‚</p><p> <img src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/r2.0/tutorials/application/source_zh_cn/cv/images/fcn_4.png" alt="fcn-4"></p></li><li><p>è·³è·ƒç»“æ„ï¼ˆSkip Layerï¼‰</p><p> åˆ©ç”¨ä¸Šé‡‡æ ·æŠ€å·§å¯¹æœ€åä¸€å±‚çš„ç‰¹å¾å›¾è¿›è¡Œä¸Šé‡‡æ ·å¾—åˆ°åŸå›¾å¤§å°çš„åˆ†å‰²æ˜¯æ­¥é•¿ä¸º32åƒç´ çš„é¢„æµ‹ï¼Œç§°ä¹‹ä¸ºFCN-32sã€‚ç”±äºæœ€åä¸€å±‚çš„ç‰¹å¾å›¾å¤ªå°ï¼ŒæŸå¤±è¿‡å¤šç»†èŠ‚ï¼Œé‡‡ç”¨skipsç»“æ„å°†æ›´å…·æœ‰å…¨å±€ä¿¡æ¯çš„æœ€åä¸€å±‚é¢„æµ‹å’Œæ›´æµ…å±‚çš„é¢„æµ‹ç»“åˆï¼Œä½¿é¢„æµ‹ç»“æœè·å–æ›´å¤šçš„å±€éƒ¨ç»†èŠ‚ã€‚å°†åº•å±‚ï¼ˆstride 32ï¼‰çš„é¢„æµ‹ï¼ˆFCN-32sï¼‰è¿›è¡Œ2å€çš„ä¸Šé‡‡æ ·å¾—åˆ°åŸå°ºå¯¸çš„å›¾åƒï¼Œå¹¶ä¸ä»pool4å±‚ï¼ˆstride 16ï¼‰è¿›è¡Œçš„é¢„æµ‹èåˆèµ·æ¥ï¼ˆç›¸åŠ ï¼‰ï¼Œè¿™ä¸€éƒ¨åˆ†çš„ç½‘ç»œè¢«ç§°ä¸ºFCN-16sã€‚éšåå°†è¿™ä¸€éƒ¨åˆ†çš„é¢„æµ‹å†è¿›è¡Œä¸€æ¬¡2å€çš„ä¸Šé‡‡æ ·å¹¶ä¸ä»pool3å±‚å¾—åˆ°çš„é¢„æµ‹èåˆèµ·æ¥ï¼Œè¿™ä¸€éƒ¨åˆ†çš„ç½‘ç»œè¢«ç§°ä¸ºFCN-8sã€‚ Skipsç»“æ„å°†æ·±å±‚çš„å…¨å±€ä¿¡æ¯ä¸æµ…å±‚çš„å±€éƒ¨ä¿¡æ¯ç›¸ç»“åˆã€‚</p><p> <img src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/r2.0/tutorials/application/source_zh_cn/cv/images/fcn_5.png" alt="fcn-5"></p></li></ol><h2 id="ç½‘ç»œç‰¹ç‚¹"><a href="#ç½‘ç»œç‰¹ç‚¹" class="headerlink" title="ç½‘ç»œç‰¹ç‚¹"></a>ç½‘ç»œç‰¹ç‚¹</h2><ol><li>ä¸å«å…¨è¿æ¥å±‚(fc)çš„å…¨å·ç§¯(fully&nbsp;conv)ç½‘ç»œï¼Œå¯é€‚åº”ä»»æ„å°ºå¯¸è¾“å…¥ã€‚  </li><li>å¢å¤§æ•°æ®å°ºå¯¸çš„åå·ç§¯(deconv)å±‚ï¼Œèƒ½å¤Ÿè¾“å‡ºç²¾ç»†çš„ç»“æœã€‚  </li><li>ç»“åˆä¸åŒæ·±åº¦å±‚ç»“æœçš„è·³çº§(skip)ç»“æ„ï¼ŒåŒæ—¶ç¡®ä¿é²æ£’æ€§å’Œç²¾ç¡®æ€§ã€‚</li></ol><h2 id="æ•°æ®å¤„ç†"><a href="#æ•°æ®å¤„ç†" class="headerlink" title="æ•°æ®å¤„ç†"></a>æ•°æ®å¤„ç†</h2><p>å¼€å§‹å®éªŒå‰ï¼Œéœ€ç¡®ä¿æœ¬åœ°å·²ç»å®‰è£…Pythonç¯å¢ƒåŠMindSporeã€‚</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> download <span class="token keyword">import</span> downloadurl <span class="token operator">=</span> <span class="token string">"https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/notebook/datasets/dataset_fcn8s.tar"</span>download<span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token string">"./dataset"</span><span class="token punctuation">,</span> kind<span class="token operator">=</span><span class="token string">"tar"</span><span class="token punctuation">,</span> replace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æ•°æ®é¢„å¤„ç†"><a href="#æ•°æ®é¢„å¤„ç†" class="headerlink" title="æ•°æ®é¢„å¤„ç†"></a>æ•°æ®é¢„å¤„ç†</h3><p>ç”±äºPASCAL VOC 2012æ•°æ®é›†ä¸­å›¾åƒçš„åˆ†è¾¨ç‡å¤§å¤šä¸ä¸€è‡´ï¼Œæ— æ³•æ”¾åœ¨ä¸€ä¸ªtensorä¸­ï¼Œæ•…è¾“å…¥å‰éœ€åšæ ‡å‡†åŒ–å¤„ç†ã€‚</p><h3 id="æ•°æ®åŠ è½½"><a href="#æ•°æ®åŠ è½½" class="headerlink" title="æ•°æ®åŠ è½½"></a>æ•°æ®åŠ è½½</h3><p>å°†PASCAL VOC 2012æ•°æ®é›†ä¸SDBæ•°æ®é›†è¿›è¡Œæ··åˆã€‚</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">import</span> cv2<span class="token keyword">import</span> mindspore<span class="token punctuation">.</span>dataset <span class="token keyword">as</span> ds<span class="token keyword">class</span> <span class="token class-name">SegDataset</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>                 image_mean<span class="token punctuation">,</span>                 image_std<span class="token punctuation">,</span>                 data_file<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">,</span>                 batch_size<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span>                 crop_size<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">,</span>                 max_scale<span class="token operator">=</span><span class="token number">2.0</span><span class="token punctuation">,</span>                 min_scale<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>                 ignore_label<span class="token operator">=</span><span class="token number">255</span><span class="token punctuation">,</span>                 num_classes<span class="token operator">=</span><span class="token number">21</span><span class="token punctuation">,</span>                 num_readers<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>                 num_parallel_calls<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>data_file <span class="token operator">=</span> data_file        self<span class="token punctuation">.</span>batch_size <span class="token operator">=</span> batch_size        self<span class="token punctuation">.</span>crop_size <span class="token operator">=</span> crop_size        self<span class="token punctuation">.</span>image_mean <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>image_mean<span class="token punctuation">,</span> dtype<span class="token operator">=</span>np<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>image_std <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>image_std<span class="token punctuation">,</span> dtype<span class="token operator">=</span>np<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>max_scale <span class="token operator">=</span> max_scale        self<span class="token punctuation">.</span>min_scale <span class="token operator">=</span> min_scale        self<span class="token punctuation">.</span>ignore_label <span class="token operator">=</span> ignore_label        self<span class="token punctuation">.</span>num_classes <span class="token operator">=</span> num_classes        self<span class="token punctuation">.</span>num_readers <span class="token operator">=</span> num_readers        self<span class="token punctuation">.</span>num_parallel_calls <span class="token operator">=</span> num_parallel_calls        max_scale <span class="token operator">&gt;</span> min_scale    <span class="token keyword">def</span> <span class="token function">preprocess_dataset</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> image<span class="token punctuation">,</span> label<span class="token punctuation">)</span><span class="token punctuation">:</span>        image_out <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imdecode<span class="token punctuation">(</span>np<span class="token punctuation">.</span>frombuffer<span class="token punctuation">(</span>image<span class="token punctuation">,</span> dtype<span class="token operator">=</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>IMREAD_COLOR<span class="token punctuation">)</span>        label_out <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imdecode<span class="token punctuation">(</span>np<span class="token punctuation">.</span>frombuffer<span class="token punctuation">(</span>label<span class="token punctuation">,</span> dtype<span class="token operator">=</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>IMREAD_GRAYSCALE<span class="token punctuation">)</span>        sc <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span>self<span class="token punctuation">.</span>min_scale<span class="token punctuation">,</span> self<span class="token punctuation">.</span>max_scale<span class="token punctuation">)</span>        new_h<span class="token punctuation">,</span> new_w <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>sc <span class="token operator">*</span> image_out<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>sc <span class="token operator">*</span> image_out<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        image_out <span class="token operator">=</span> cv2<span class="token punctuation">.</span>resize<span class="token punctuation">(</span>image_out<span class="token punctuation">,</span> <span class="token punctuation">(</span>new_w<span class="token punctuation">,</span> new_h<span class="token punctuation">)</span><span class="token punctuation">,</span> interpolation<span class="token operator">=</span>cv2<span class="token punctuation">.</span>INTER_CUBIC<span class="token punctuation">)</span>        label_out <span class="token operator">=</span> cv2<span class="token punctuation">.</span>resize<span class="token punctuation">(</span>label_out<span class="token punctuation">,</span> <span class="token punctuation">(</span>new_w<span class="token punctuation">,</span> new_h<span class="token punctuation">)</span><span class="token punctuation">,</span> interpolation<span class="token operator">=</span>cv2<span class="token punctuation">.</span>INTER_NEAREST<span class="token punctuation">)</span>        image_out <span class="token operator">=</span> <span class="token punctuation">(</span>image_out <span class="token operator">-</span> self<span class="token punctuation">.</span>image_mean<span class="token punctuation">)</span> <span class="token operator">/</span> self<span class="token punctuation">.</span>image_std        out_h<span class="token punctuation">,</span> out_w <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span>new_h<span class="token punctuation">,</span> self<span class="token punctuation">.</span>crop_size<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">max</span><span class="token punctuation">(</span>new_w<span class="token punctuation">,</span> self<span class="token punctuation">.</span>crop_size<span class="token punctuation">)</span>        pad_h<span class="token punctuation">,</span> pad_w <span class="token operator">=</span> out_h <span class="token operator">-</span> new_h<span class="token punctuation">,</span> out_w <span class="token operator">-</span> new_w        <span class="token keyword">if</span> pad_h <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">or</span> pad_w <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>            image_out <span class="token operator">=</span> cv2<span class="token punctuation">.</span>copyMakeBorder<span class="token punctuation">(</span>image_out<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> pad_h<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> pad_w<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>BORDER_CONSTANT<span class="token punctuation">,</span> value<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>            label_out <span class="token operator">=</span> cv2<span class="token punctuation">.</span>copyMakeBorder<span class="token punctuation">(</span>label_out<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> pad_h<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> pad_w<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>BORDER_CONSTANT<span class="token punctuation">,</span> value<span class="token operator">=</span>self<span class="token punctuation">.</span>ignore_label<span class="token punctuation">)</span>        offset_h <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> out_h <span class="token operator">-</span> self<span class="token punctuation">.</span>crop_size <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>        offset_w <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> out_w <span class="token operator">-</span> self<span class="token punctuation">.</span>crop_size <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>        image_out <span class="token operator">=</span> image_out<span class="token punctuation">[</span>offset_h<span class="token punctuation">:</span> offset_h <span class="token operator">+</span> self<span class="token punctuation">.</span>crop_size<span class="token punctuation">,</span> offset_w<span class="token punctuation">:</span> offset_w <span class="token operator">+</span> self<span class="token punctuation">.</span>crop_size<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>        label_out <span class="token operator">=</span> label_out<span class="token punctuation">[</span>offset_h<span class="token punctuation">:</span> offset_h <span class="token operator">+</span> self<span class="token punctuation">.</span>crop_size<span class="token punctuation">,</span> offset_w<span class="token punctuation">:</span> offset_w<span class="token operator">+</span>self<span class="token punctuation">.</span>crop_size<span class="token punctuation">]</span>        <span class="token keyword">if</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0.5</span><span class="token punctuation">:</span>            image_out <span class="token operator">=</span> image_out<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>            label_out <span class="token operator">=</span> label_out<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>        image_out <span class="token operator">=</span> image_out<span class="token punctuation">.</span>transpose<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        image_out <span class="token operator">=</span> image_out<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>        label_out <span class="token operator">=</span> label_out<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>        label_out <span class="token operator">=</span> label_out<span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">"int32"</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> image_out<span class="token punctuation">,</span> label_out    <span class="token keyword">def</span> <span class="token function">get_dataset</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        ds<span class="token punctuation">.</span>config<span class="token punctuation">.</span>set_numa_enable<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>        dataset <span class="token operator">=</span> ds<span class="token punctuation">.</span>MindDataset<span class="token punctuation">(</span>self<span class="token punctuation">.</span>data_file<span class="token punctuation">,</span> columns_list<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">,</span> <span class="token string">"label"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                                 shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> num_parallel_workers<span class="token operator">=</span>self<span class="token punctuation">.</span>num_readers<span class="token punctuation">)</span>        transforms_list <span class="token operator">=</span> self<span class="token punctuation">.</span>preprocess_dataset        dataset <span class="token operator">=</span> dataset<span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span>operations<span class="token operator">=</span>transforms_list<span class="token punctuation">,</span> input_columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">,</span> <span class="token string">"label"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                              output_columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">,</span> <span class="token string">"label"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                              num_parallel_workers<span class="token operator">=</span>self<span class="token punctuation">.</span>num_parallel_calls<span class="token punctuation">)</span>        dataset <span class="token operator">=</span> dataset<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>buffer_size<span class="token operator">=</span>self<span class="token punctuation">.</span>batch_size <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">)</span>        dataset <span class="token operator">=</span> dataset<span class="token punctuation">.</span>batch<span class="token punctuation">(</span>self<span class="token punctuation">.</span>batch_size<span class="token punctuation">,</span> drop_remainder<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> dataset<span class="token comment"># å®šä¹‰åˆ›å»ºæ•°æ®é›†çš„å‚æ•°</span>IMAGE_MEAN <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">103.53</span><span class="token punctuation">,</span> <span class="token number">116.28</span><span class="token punctuation">,</span> <span class="token number">123.675</span><span class="token punctuation">]</span>IMAGE_STD <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">57.375</span><span class="token punctuation">,</span> <span class="token number">57.120</span><span class="token punctuation">,</span> <span class="token number">58.395</span><span class="token punctuation">]</span>DATA_FILE <span class="token operator">=</span> <span class="token string">"dataset/dataset_fcn8s/mindname.mindrecord"</span><span class="token comment"># å®šä¹‰æ¨¡å‹è®­ç»ƒå‚æ•°</span>train_batch_size <span class="token operator">=</span> <span class="token number">4</span>crop_size <span class="token operator">=</span> <span class="token number">512</span>min_scale <span class="token operator">=</span> <span class="token number">0.5</span>max_scale <span class="token operator">=</span> <span class="token number">2.0</span>ignore_label <span class="token operator">=</span> <span class="token number">255</span>num_classes <span class="token operator">=</span> <span class="token number">21</span><span class="token comment"># å®ä¾‹åŒ–Dataset</span>dataset <span class="token operator">=</span> SegDataset<span class="token punctuation">(</span>image_mean<span class="token operator">=</span>IMAGE_MEAN<span class="token punctuation">,</span>                     image_std<span class="token operator">=</span>IMAGE_STD<span class="token punctuation">,</span>                     data_file<span class="token operator">=</span>DATA_FILE<span class="token punctuation">,</span>                     batch_size<span class="token operator">=</span>train_batch_size<span class="token punctuation">,</span>                     crop_size<span class="token operator">=</span>crop_size<span class="token punctuation">,</span>                     max_scale<span class="token operator">=</span>max_scale<span class="token punctuation">,</span>                     min_scale<span class="token operator">=</span>min_scale<span class="token punctuation">,</span>                     ignore_label<span class="token operator">=</span>ignore_label<span class="token punctuation">,</span>                     num_classes<span class="token operator">=</span>num_classes<span class="token punctuation">,</span>                     num_readers<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>                     num_parallel_calls<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span>dataset <span class="token operator">=</span> dataset<span class="token punctuation">.</span>get_dataset<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è®­ç»ƒé›†å¯è§†åŒ–"><a href="#è®­ç»ƒé›†å¯è§†åŒ–" class="headerlink" title="è®­ç»ƒé›†å¯è§†åŒ–"></a>è®­ç»ƒé›†å¯è§†åŒ–</h3><p>è¿è¡Œä»¥ä¸‹ä»£ç è§‚å¯Ÿè½½å…¥çš„æ•°æ®é›†å›¾ç‰‡ï¼ˆæ•°æ®å¤„ç†è¿‡ç¨‹ä¸­å·²åšå½’ä¸€åŒ–å¤„ç†ï¼‰ã€‚</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> pltplt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># å¯¹è®­ç»ƒé›†ä¸­çš„æ•°æ®è¿›è¡Œå±•ç¤º</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>    show_data <span class="token operator">=</span> <span class="token builtin">next</span><span class="token punctuation">(</span>dataset<span class="token punctuation">.</span>create_dict_iterator<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    show_images <span class="token operator">=</span> show_data<span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>asnumpy<span class="token punctuation">(</span><span class="token punctuation">)</span>    show_images <span class="token operator">=</span> np<span class="token punctuation">.</span>clip<span class="token punctuation">(</span>show_images<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token comment"># å°†å›¾ç‰‡è½¬æ¢HWCæ ¼å¼åè¿›è¡Œå±•ç¤º</span>    plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>show_images<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>transpose<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">"off"</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>subplots_adjust<span class="token punctuation">(</span>wspace<span class="token operator">=</span><span class="token number">0.05</span><span class="token punctuation">,</span> hspace<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://niubi-1316733611.cos.ap-beijing.myqcloud.com/mindspore_fcn8s_7_0.png" alt="png"></p><h2 id="ç½‘ç»œæ„å»º"><a href="#ç½‘ç»œæ„å»º" class="headerlink" title="ç½‘ç»œæ„å»º"></a>ç½‘ç»œæ„å»º</h2><h3 id="ç½‘ç»œæµç¨‹"><a href="#ç½‘ç»œæµç¨‹" class="headerlink" title="ç½‘ç»œæµç¨‹"></a>ç½‘ç»œæµç¨‹</h3><p>FCNç½‘ç»œçš„æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><ol><li>è¾“å…¥å›¾åƒimageï¼Œç»è¿‡pool1æ± åŒ–åï¼Œå°ºå¯¸å˜ä¸ºåŸå§‹å°ºå¯¸çš„1/2ã€‚</li><li>ç»è¿‡pool2æ± åŒ–ï¼Œå°ºå¯¸å˜ä¸ºåŸå§‹å°ºå¯¸çš„1/4ã€‚</li><li>æ¥ç€ç»è¿‡pool3ã€pool4ã€pool5æ± åŒ–ï¼Œå¤§å°åˆ†åˆ«å˜ä¸ºåŸå§‹å°ºå¯¸çš„1/8ã€1/16ã€1/32ã€‚</li><li>ç»è¿‡conv6-7å·ç§¯ï¼Œè¾“å‡ºçš„å°ºå¯¸ä¾ç„¶æ˜¯åŸå›¾çš„1/32ã€‚</li><li>FCN-32sæ˜¯æœ€åä½¿ç”¨åå·ç§¯ï¼Œä½¿å¾—è¾“å‡ºå›¾åƒå¤§å°ä¸è¾“å…¥å›¾åƒç›¸åŒã€‚</li><li>FCN-16sæ˜¯å°†conv7çš„è¾“å‡ºè¿›è¡Œåå·ç§¯ï¼Œä½¿å…¶å°ºå¯¸æ‰©å¤§ä¸¤å€è‡³åŸå›¾çš„1/16ï¼Œå¹¶å°†å…¶ä¸pool4è¾“å‡ºçš„ç‰¹å¾å›¾è¿›è¡Œèåˆï¼Œåé€šè¿‡åå·ç§¯æ‰©å¤§åˆ°åŸå§‹å°ºå¯¸ã€‚</li><li>FCN-8sæ˜¯å°†conv7çš„è¾“å‡ºè¿›è¡Œåå·ç§¯æ‰©å¤§4å€ï¼Œå°†pool4è¾“å‡ºçš„ç‰¹å¾å›¾åå·ç§¯æ‰©å¤§2å€ï¼Œå¹¶å°†pool3è¾“å‡ºç‰¹å¾å›¾æ‹¿å‡ºï¼Œä¸‰è€…èåˆåé€šåå·ç§¯æ‰©å¤§åˆ°åŸå§‹å°ºå¯¸ã€‚</li></ol><p><img src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/r2.0/tutorials/application/source_zh_cn/cv/images/fcn_6.png" alt="fcn-6"></p><p>ä½¿ç”¨ä»¥ä¸‹ä»£ç æ„å»ºFCN-8sç½‘ç»œã€‚</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> mindspore<span class="token punctuation">.</span>nn <span class="token keyword">as</span> nn<span class="token keyword">class</span> <span class="token class-name">FCN8s</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Cell<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> n_class<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>n_class <span class="token operator">=</span> n_class        self<span class="token punctuation">.</span>conv1 <span class="token operator">=</span> nn<span class="token punctuation">.</span>SequentialCell<span class="token punctuation">(</span>            nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>in_channels<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> out_channels<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>                      kernel_size<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> weight_init<span class="token operator">=</span><span class="token string">'xavier_uniform'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>BatchNorm2d<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>in_channels<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span> out_channels<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>                      kernel_size<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> weight_init<span class="token operator">=</span><span class="token string">'xavier_uniform'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>BatchNorm2d<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pool1 <span class="token operator">=</span> nn<span class="token punctuation">.</span>MaxPool2d<span class="token punctuation">(</span>kernel_size<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>conv2 <span class="token operator">=</span> nn<span class="token punctuation">.</span>SequentialCell<span class="token punctuation">(</span>            nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>in_channels<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span> out_channels<span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">,</span>                      kernel_size<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> weight_init<span class="token operator">=</span><span class="token string">'xavier_uniform'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>BatchNorm2d<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>in_channels<span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">,</span> out_channels<span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">,</span>                      kernel_size<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> weight_init<span class="token operator">=</span><span class="token string">'xavier_uniform'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>BatchNorm2d<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pool2 <span class="token operator">=</span> nn<span class="token punctuation">.</span>MaxPool2d<span class="token punctuation">(</span>kernel_size<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>conv3 <span class="token operator">=</span> nn<span class="token punctuation">.</span>SequentialCell<span class="token punctuation">(</span>            nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>in_channels<span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">,</span> out_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>                      kernel_size<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> weight_init<span class="token operator">=</span><span class="token string">'xavier_uniform'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>BatchNorm2d<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>in_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span> out_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>                      kernel_size<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> weight_init<span class="token operator">=</span><span class="token string">'xavier_uniform'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>BatchNorm2d<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>in_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span> out_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>                      kernel_size<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> weight_init<span class="token operator">=</span><span class="token string">'xavier_uniform'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>BatchNorm2d<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pool3 <span class="token operator">=</span> nn<span class="token punctuation">.</span>MaxPool2d<span class="token punctuation">(</span>kernel_size<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>conv4 <span class="token operator">=</span> nn<span class="token punctuation">.</span>SequentialCell<span class="token punctuation">(</span>            nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>in_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span> out_channels<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">,</span>                      kernel_size<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> weight_init<span class="token operator">=</span><span class="token string">'xavier_uniform'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>BatchNorm2d<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>in_channels<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">,</span> out_channels<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">,</span>                      kernel_size<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> weight_init<span class="token operator">=</span><span class="token string">'xavier_uniform'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>BatchNorm2d<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>in_channels<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">,</span> out_channels<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">,</span>                      kernel_size<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> weight_init<span class="token operator">=</span><span class="token string">'xavier_uniform'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>BatchNorm2d<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pool4 <span class="token operator">=</span> nn<span class="token punctuation">.</span>MaxPool2d<span class="token punctuation">(</span>kernel_size<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>conv5 <span class="token operator">=</span> nn<span class="token punctuation">.</span>SequentialCell<span class="token punctuation">(</span>            nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>in_channels<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">,</span> out_channels<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">,</span>                      kernel_size<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> weight_init<span class="token operator">=</span><span class="token string">'xavier_uniform'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>BatchNorm2d<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>in_channels<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">,</span> out_channels<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">,</span>                      kernel_size<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> weight_init<span class="token operator">=</span><span class="token string">'xavier_uniform'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>BatchNorm2d<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>in_channels<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">,</span> out_channels<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">,</span>                      kernel_size<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> weight_init<span class="token operator">=</span><span class="token string">'xavier_uniform'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>BatchNorm2d<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pool5 <span class="token operator">=</span> nn<span class="token punctuation">.</span>MaxPool2d<span class="token punctuation">(</span>kernel_size<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>conv6 <span class="token operator">=</span> nn<span class="token punctuation">.</span>SequentialCell<span class="token punctuation">(</span>            nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>in_channels<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">,</span> out_channels<span class="token operator">=</span><span class="token number">4096</span><span class="token punctuation">,</span>                      kernel_size<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">,</span> weight_init<span class="token operator">=</span><span class="token string">'xavier_uniform'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>BatchNorm2d<span class="token punctuation">(</span><span class="token number">4096</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        <span class="token punctuation">)</span>        self<span class="token punctuation">.</span>conv7 <span class="token operator">=</span> nn<span class="token punctuation">.</span>SequentialCell<span class="token punctuation">(</span>            nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>in_channels<span class="token operator">=</span><span class="token number">4096</span><span class="token punctuation">,</span> out_channels<span class="token operator">=</span><span class="token number">4096</span><span class="token punctuation">,</span>                      kernel_size<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> weight_init<span class="token operator">=</span><span class="token string">'xavier_uniform'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>BatchNorm2d<span class="token punctuation">(</span><span class="token number">4096</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        <span class="token punctuation">)</span>        self<span class="token punctuation">.</span>score_fr <span class="token operator">=</span> nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>in_channels<span class="token operator">=</span><span class="token number">4096</span><span class="token punctuation">,</span> out_channels<span class="token operator">=</span>self<span class="token punctuation">.</span>n_class<span class="token punctuation">,</span>                                  kernel_size<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> weight_init<span class="token operator">=</span><span class="token string">'xavier_uniform'</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>upscore2 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Conv2dTranspose<span class="token punctuation">(</span>in_channels<span class="token operator">=</span>self<span class="token punctuation">.</span>n_class<span class="token punctuation">,</span> out_channels<span class="token operator">=</span>self<span class="token punctuation">.</span>n_class<span class="token punctuation">,</span>                                           kernel_size<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> weight_init<span class="token operator">=</span><span class="token string">'xavier_uniform'</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>score_pool4 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>in_channels<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">,</span> out_channels<span class="token operator">=</span>self<span class="token punctuation">.</span>n_class<span class="token punctuation">,</span>                                     kernel_size<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> weight_init<span class="token operator">=</span><span class="token string">'xavier_uniform'</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>upscore_pool4 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Conv2dTranspose<span class="token punctuation">(</span>in_channels<span class="token operator">=</span>self<span class="token punctuation">.</span>n_class<span class="token punctuation">,</span> out_channels<span class="token operator">=</span>self<span class="token punctuation">.</span>n_class<span class="token punctuation">,</span>                                                kernel_size<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> weight_init<span class="token operator">=</span><span class="token string">'xavier_uniform'</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>score_pool3 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>in_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span> out_channels<span class="token operator">=</span>self<span class="token punctuation">.</span>n_class<span class="token punctuation">,</span>                                     kernel_size<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> weight_init<span class="token operator">=</span><span class="token string">'xavier_uniform'</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>upscore8 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Conv2dTranspose<span class="token punctuation">(</span>in_channels<span class="token operator">=</span>self<span class="token punctuation">.</span>n_class<span class="token punctuation">,</span> out_channels<span class="token operator">=</span>self<span class="token punctuation">.</span>n_class<span class="token punctuation">,</span>                                           kernel_size<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">,</span> weight_init<span class="token operator">=</span><span class="token string">'xavier_uniform'</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">construct</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>        x1 <span class="token operator">=</span> self<span class="token punctuation">.</span>conv1<span class="token punctuation">(</span>x<span class="token punctuation">)</span>        p1 <span class="token operator">=</span> self<span class="token punctuation">.</span>pool1<span class="token punctuation">(</span>x1<span class="token punctuation">)</span>        x2 <span class="token operator">=</span> self<span class="token punctuation">.</span>conv2<span class="token punctuation">(</span>p1<span class="token punctuation">)</span>        p2 <span class="token operator">=</span> self<span class="token punctuation">.</span>pool2<span class="token punctuation">(</span>x2<span class="token punctuation">)</span>        x3 <span class="token operator">=</span> self<span class="token punctuation">.</span>conv3<span class="token punctuation">(</span>p2<span class="token punctuation">)</span>        p3 <span class="token operator">=</span> self<span class="token punctuation">.</span>pool3<span class="token punctuation">(</span>x3<span class="token punctuation">)</span>        x4 <span class="token operator">=</span> self<span class="token punctuation">.</span>conv4<span class="token punctuation">(</span>p3<span class="token punctuation">)</span>        p4 <span class="token operator">=</span> self<span class="token punctuation">.</span>pool4<span class="token punctuation">(</span>x4<span class="token punctuation">)</span>        x5 <span class="token operator">=</span> self<span class="token punctuation">.</span>conv5<span class="token punctuation">(</span>p4<span class="token punctuation">)</span>        p5 <span class="token operator">=</span> self<span class="token punctuation">.</span>pool5<span class="token punctuation">(</span>x5<span class="token punctuation">)</span>        x6 <span class="token operator">=</span> self<span class="token punctuation">.</span>conv6<span class="token punctuation">(</span>p5<span class="token punctuation">)</span>        x7 <span class="token operator">=</span> self<span class="token punctuation">.</span>conv7<span class="token punctuation">(</span>x6<span class="token punctuation">)</span>        sf <span class="token operator">=</span> self<span class="token punctuation">.</span>score_fr<span class="token punctuation">(</span>x7<span class="token punctuation">)</span>        u2 <span class="token operator">=</span> self<span class="token punctuation">.</span>upscore2<span class="token punctuation">(</span>sf<span class="token punctuation">)</span>        s4 <span class="token operator">=</span> self<span class="token punctuation">.</span>score_pool4<span class="token punctuation">(</span>p4<span class="token punctuation">)</span>        f4 <span class="token operator">=</span> s4 <span class="token operator">+</span> u2        u4 <span class="token operator">=</span> self<span class="token punctuation">.</span>upscore_pool4<span class="token punctuation">(</span>f4<span class="token punctuation">)</span>        s3 <span class="token operator">=</span> self<span class="token punctuation">.</span>score_pool3<span class="token punctuation">(</span>p3<span class="token punctuation">)</span>        f3 <span class="token operator">=</span> s3 <span class="token operator">+</span> u4        out <span class="token operator">=</span> self<span class="token punctuation">.</span>upscore8<span class="token punctuation">(</span>f3<span class="token punctuation">)</span>        <span class="token keyword">return</span> out<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="è®­ç»ƒå‡†å¤‡"><a href="#è®­ç»ƒå‡†å¤‡" class="headerlink" title="è®­ç»ƒå‡†å¤‡"></a>è®­ç»ƒå‡†å¤‡</h2><h3 id="å¯¼å…¥VGG-16éƒ¨åˆ†é¢„è®­ç»ƒæƒé‡"><a href="#å¯¼å…¥VGG-16éƒ¨åˆ†é¢„è®­ç»ƒæƒé‡" class="headerlink" title="å¯¼å…¥VGG-16éƒ¨åˆ†é¢„è®­ç»ƒæƒé‡"></a>å¯¼å…¥VGG-16éƒ¨åˆ†é¢„è®­ç»ƒæƒé‡</h3><p>FCNä½¿ç”¨VGG-16ä½œä¸ºéª¨å¹²ç½‘ç»œï¼Œç”¨äºå®ç°å›¾åƒç¼–ç ã€‚ä½¿ç”¨ä¸‹é¢ä»£ç å¯¼å…¥VGG-16é¢„è®­ç»ƒæ¨¡å‹çš„éƒ¨åˆ†é¢„è®­ç»ƒæƒé‡ã€‚</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> download <span class="token keyword">import</span> download<span class="token keyword">from</span> mindspore <span class="token keyword">import</span> load_checkpoint<span class="token punctuation">,</span> load_param_into_neturl <span class="token operator">=</span> <span class="token string">"https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/notebook/datasets/fcn8s_vgg16_pretrain.ckpt"</span>download<span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token string">"fcn8s_vgg16_pretrain.ckpt"</span><span class="token punctuation">,</span> replace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">load_vgg16</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    ckpt_vgg16 <span class="token operator">=</span> <span class="token string">"fcn8s_vgg16_pretrain.ckpt"</span>    param_vgg <span class="token operator">=</span> load_checkpoint<span class="token punctuation">(</span>ckpt_vgg16<span class="token punctuation">)</span>    load_param_into_net<span class="token punctuation">(</span>net<span class="token punctuation">,</span> param_vgg<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æŸå¤±å‡½æ•°"><a href="#æŸå¤±å‡½æ•°" class="headerlink" title="æŸå¤±å‡½æ•°"></a>æŸå¤±å‡½æ•°</h3><p>è¯­ä¹‰åˆ†å‰²æ˜¯å¯¹å›¾åƒä¸­æ¯ä¸ªåƒç´ ç‚¹è¿›è¡Œåˆ†ç±»ï¼Œä»æ˜¯åˆ†ç±»é—®é¢˜ï¼Œæ•…æŸå¤±å‡½æ•°é€‰æ‹©äº¤å‰ç†µæŸå¤±å‡½æ•°æ¥è®¡ç®—FCNç½‘ç»œè¾“å‡ºä¸maskä¹‹é—´çš„äº¤å‰ç†µæŸå¤±ã€‚è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯mindspore.nn.CrossEntropyLoss()ä½œä¸ºæŸå¤±å‡½æ•°ã€‚</p><h3 id="è‡ªå®šä¹‰è¯„ä»·æŒ‡æ ‡-Metrics"><a href="#è‡ªå®šä¹‰è¯„ä»·æŒ‡æ ‡-Metrics" class="headerlink" title="è‡ªå®šä¹‰è¯„ä»·æŒ‡æ ‡ Metrics"></a>è‡ªå®šä¹‰è¯„ä»·æŒ‡æ ‡ Metrics</h3><p>è¿™ä¸€éƒ¨åˆ†ä¸»è¦å¯¹è®­ç»ƒå‡ºæ¥çš„æ¨¡å‹æ•ˆæœè¿›è¡Œè¯„ä¼°ï¼Œä¸ºäº†ä¾¿äºè§£é‡Šï¼Œå‡è®¾å¦‚ä¸‹ï¼šå…±æœ‰ $k+1$ ä¸ªç±»ï¼ˆä» $L_0$ åˆ° $L_k$, å…¶ä¸­åŒ…å«ä¸€ä¸ªç©ºç±»æˆ–èƒŒæ™¯ï¼‰ï¼Œ $p_{i j}$ è¡¨ç¤ºæœ¬å±äº$i$ç±»ä½†è¢«é¢„æµ‹ä¸º$j$ç±»çš„åƒç´ æ•°é‡ã€‚å³, $p_{i i}$ è¡¨ç¤ºçœŸæ­£çš„æ•°é‡, è€Œ $p_{i j} p_{j i}$ åˆ™åˆ†åˆ«è¢«è§£é‡Šä¸ºå‡æ­£å’Œå‡è´Ÿ, å°½ç®¡ä¸¤è€…éƒ½æ˜¯å‡æ­£ä¸å‡è´Ÿä¹‹å’Œã€‚</p><ul><li>Pixel Accuracy(PA, åƒç´ ç²¾åº¦)ï¼šè¿™æ˜¯æœ€ç®€å•çš„åº¦é‡ï¼Œä¸ºæ ‡è®°æ­£ç¡®çš„åƒç´ å æ€»åƒç´ çš„æ¯”ä¾‹ã€‚</li></ul><p>$$ P A=\frac{\sum_{i=0}^k p_{i i}}{\sum_{i=0}^k \sum_{j=0}^k p_{i j}} $$</p><ul><li>Mean Pixel Accuracy(MPA, å‡åƒç´ ç²¾åº¦)ï¼šæ˜¯PAçš„ä¸€ç§ç®€å•æå‡ï¼Œè®¡ç®—æ¯ä¸ªç±»å†…è¢«æ­£ç¡®åˆ†ç±»åƒç´ æ•°çš„æ¯”ä¾‹ï¼Œä¹‹åæ±‚æ‰€æœ‰ç±»çš„å¹³å‡ã€‚</li></ul><p>$$ M P A=\frac{1}{k+1} \sum_{i=0}^k \frac{p_{i i}}{\sum_{j=0}^k p_{i j}} $$</p><ul><li>Mean Intersection over Union(MloU, å‡äº¤å¹¶æ¯”)ï¼šä¸ºè¯­ä¹‰åˆ†å‰²çš„æ ‡å‡†åº¦é‡ã€‚å…¶è®¡ç®—ä¸¤ä¸ªé›†åˆçš„äº¤é›†å’Œå¹¶é›†ä¹‹ï¼Œåœ¨è¯­ä¹‰åˆ†å‰²çš„é—®é¢˜ä¸­ï¼Œè¿™ä¸¤ä¸ªé›†åˆä¸ºçœŸå®å€¼ï¼ˆground truth) å’Œé¢„æµ‹å€¼ï¼ˆpredicted segmentationï¼‰ã€‚è¿™ä¸ªæ¯”ä¾‹å¯ä»¥å˜å½¢ä¸ºæ­£çœŸæ•° (intersection) æ¯”ä¸ŠçœŸæ­£ã€å‡è´Ÿã€å‡æ­£ï¼ˆå¹¶é›†ï¼‰ä¹‹å’Œã€‚åœ¨æ¯ä¸ªç±»ä¸Šè®¡ç®—loUï¼Œä¹‹åå¹³å‡ã€‚</li></ul><p>$$ M I o U=\frac{1}{k+1} \sum_{i=0}^k \frac{p_{i i}}{\sum_{j=0}^k p_{i j}+\sum_{j=0}^k p_{j i}-p_{i i}} $$</p><ul><li>Frequency Weighted Intersection over Union(FWIoU, é¢‘æƒäº¤äº•æ¯”)ï¼šä¸ºMloUçš„ä¸€ç§æå‡ï¼Œè¿™ç§æ–¹æ³•æ ¹æ®æ¯ä¸ªç±»å‡ºç°çš„é¢‘ç‡ä¸ºå…¶è®¾ç½®æƒé‡ã€‚</li></ul><p>$$ F W I o U=\frac{1}{\sum_{i=0}^k \sum_{j=0}^k p_{i j}} \sum_{i=0}^k \frac{p_{i i}}{\sum_{j=0}^k p_{i j}+\sum_{j=0}^k p_{j i}-p_{i i}} $$</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">import</span> mindspore <span class="token keyword">as</span> ms<span class="token keyword">import</span> mindspore<span class="token punctuation">.</span>nn <span class="token keyword">as</span> nn<span class="token keyword">import</span> mindspore<span class="token punctuation">.</span>train <span class="token keyword">as</span> train<span class="token keyword">class</span> <span class="token class-name">PixelAccuracy</span><span class="token punctuation">(</span>train<span class="token punctuation">.</span>Metric<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> num_class<span class="token operator">=</span><span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token builtin">super</span><span class="token punctuation">(</span>PixelAccuracy<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>num_class <span class="token operator">=</span> num_class    <span class="token keyword">def</span> <span class="token function">_generate_matrix</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> gt_image<span class="token punctuation">,</span> pre_image<span class="token punctuation">)</span><span class="token punctuation">:</span>        mask <span class="token operator">=</span> <span class="token punctuation">(</span>gt_image <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>gt_image <span class="token operator">&lt;</span> self<span class="token punctuation">.</span>num_class<span class="token punctuation">)</span>        label <span class="token operator">=</span> self<span class="token punctuation">.</span>num_class <span class="token operator">*</span> gt_image<span class="token punctuation">[</span>mask<span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">'int'</span><span class="token punctuation">)</span> <span class="token operator">+</span> pre_image<span class="token punctuation">[</span>mask<span class="token punctuation">]</span>        count <span class="token operator">=</span> np<span class="token punctuation">.</span>bincount<span class="token punctuation">(</span>label<span class="token punctuation">,</span> minlength<span class="token operator">=</span>self<span class="token punctuation">.</span>num_class<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span>        confusion_matrix <span class="token operator">=</span> count<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>self<span class="token punctuation">.</span>num_class<span class="token punctuation">,</span> self<span class="token punctuation">.</span>num_class<span class="token punctuation">)</span>        <span class="token keyword">return</span> confusion_matrix    <span class="token keyword">def</span> <span class="token function">clear</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>confusion_matrix <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>num_class<span class="token punctuation">,</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>inputs<span class="token punctuation">)</span><span class="token punctuation">:</span>        y_pred <span class="token operator">=</span> inputs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>asnumpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>        y <span class="token operator">=</span> inputs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>asnumpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">512</span><span class="token punctuation">,</span> <span class="token number">512</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>confusion_matrix <span class="token operator">+=</span> self<span class="token punctuation">.</span>_generate_matrix<span class="token punctuation">(</span>y<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">eval</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        pixel_accuracy <span class="token operator">=</span> np<span class="token punctuation">.</span>diag<span class="token punctuation">(</span>self<span class="token punctuation">.</span>confusion_matrix<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> self<span class="token punctuation">.</span>confusion_matrix<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> pixel_accuracy<span class="token keyword">class</span> <span class="token class-name">PixelAccuracyClass</span><span class="token punctuation">(</span>train<span class="token punctuation">.</span>Metric<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> num_class<span class="token operator">=</span><span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token builtin">super</span><span class="token punctuation">(</span>PixelAccuracyClass<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>num_class <span class="token operator">=</span> num_class    <span class="token keyword">def</span> <span class="token function">_generate_matrix</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> gt_image<span class="token punctuation">,</span> pre_image<span class="token punctuation">)</span><span class="token punctuation">:</span>        mask <span class="token operator">=</span> <span class="token punctuation">(</span>gt_image <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>gt_image <span class="token operator">&lt;</span> self<span class="token punctuation">.</span>num_class<span class="token punctuation">)</span>        label <span class="token operator">=</span> self<span class="token punctuation">.</span>num_class <span class="token operator">*</span> gt_image<span class="token punctuation">[</span>mask<span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">'int'</span><span class="token punctuation">)</span> <span class="token operator">+</span> pre_image<span class="token punctuation">[</span>mask<span class="token punctuation">]</span>        count <span class="token operator">=</span> np<span class="token punctuation">.</span>bincount<span class="token punctuation">(</span>label<span class="token punctuation">,</span> minlength<span class="token operator">=</span>self<span class="token punctuation">.</span>num_class<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span>        confusion_matrix <span class="token operator">=</span> count<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>self<span class="token punctuation">.</span>num_class<span class="token punctuation">,</span> self<span class="token punctuation">.</span>num_class<span class="token punctuation">)</span>        <span class="token keyword">return</span> confusion_matrix    <span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>inputs<span class="token punctuation">)</span><span class="token punctuation">:</span>        y_pred <span class="token operator">=</span> inputs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>asnumpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>        y <span class="token operator">=</span> inputs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>asnumpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">512</span><span class="token punctuation">,</span> <span class="token number">512</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>confusion_matrix <span class="token operator">+=</span> self<span class="token punctuation">.</span>_generate_matrix<span class="token punctuation">(</span>y<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">clear</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>confusion_matrix <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>num_class<span class="token punctuation">,</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">eval</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        mean_pixel_accuracy <span class="token operator">=</span> np<span class="token punctuation">.</span>diag<span class="token punctuation">(</span>self<span class="token punctuation">.</span>confusion_matrix<span class="token punctuation">)</span> <span class="token operator">/</span> self<span class="token punctuation">.</span>confusion_matrix<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>        mean_pixel_accuracy <span class="token operator">=</span> np<span class="token punctuation">.</span>nanmean<span class="token punctuation">(</span>mean_pixel_accuracy<span class="token punctuation">)</span>        <span class="token keyword">return</span> mean_pixel_accuracy<span class="token keyword">class</span> <span class="token class-name">MeanIntersectionOverUnion</span><span class="token punctuation">(</span>train<span class="token punctuation">.</span>Metric<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> num_class<span class="token operator">=</span><span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token builtin">super</span><span class="token punctuation">(</span>MeanIntersectionOverUnion<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>num_class <span class="token operator">=</span> num_class    <span class="token keyword">def</span> <span class="token function">_generate_matrix</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> gt_image<span class="token punctuation">,</span> pre_image<span class="token punctuation">)</span><span class="token punctuation">:</span>        mask <span class="token operator">=</span> <span class="token punctuation">(</span>gt_image <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>gt_image <span class="token operator">&lt;</span> self<span class="token punctuation">.</span>num_class<span class="token punctuation">)</span>        label <span class="token operator">=</span> self<span class="token punctuation">.</span>num_class <span class="token operator">*</span> gt_image<span class="token punctuation">[</span>mask<span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">'int'</span><span class="token punctuation">)</span> <span class="token operator">+</span> pre_image<span class="token punctuation">[</span>mask<span class="token punctuation">]</span>        count <span class="token operator">=</span> np<span class="token punctuation">.</span>bincount<span class="token punctuation">(</span>label<span class="token punctuation">,</span> minlength<span class="token operator">=</span>self<span class="token punctuation">.</span>num_class<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span>        confusion_matrix <span class="token operator">=</span> count<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>self<span class="token punctuation">.</span>num_class<span class="token punctuation">,</span> self<span class="token punctuation">.</span>num_class<span class="token punctuation">)</span>        <span class="token keyword">return</span> confusion_matrix    <span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>inputs<span class="token punctuation">)</span><span class="token punctuation">:</span>        y_pred <span class="token operator">=</span> inputs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>asnumpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>        y <span class="token operator">=</span> inputs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>asnumpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">512</span><span class="token punctuation">,</span> <span class="token number">512</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>confusion_matrix <span class="token operator">+=</span> self<span class="token punctuation">.</span>_generate_matrix<span class="token punctuation">(</span>y<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">clear</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>confusion_matrix <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>num_class<span class="token punctuation">,</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">eval</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        mean_iou <span class="token operator">=</span> np<span class="token punctuation">.</span>diag<span class="token punctuation">(</span>self<span class="token punctuation">.</span>confusion_matrix<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>            np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>confusion_matrix<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>confusion_matrix<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">-</span>            np<span class="token punctuation">.</span>diag<span class="token punctuation">(</span>self<span class="token punctuation">.</span>confusion_matrix<span class="token punctuation">)</span><span class="token punctuation">)</span>        mean_iou <span class="token operator">=</span> np<span class="token punctuation">.</span>nanmean<span class="token punctuation">(</span>mean_iou<span class="token punctuation">)</span>        <span class="token keyword">return</span> mean_iou<span class="token keyword">class</span> <span class="token class-name">FrequencyWeightedIntersectionOverUnion</span><span class="token punctuation">(</span>train<span class="token punctuation">.</span>Metric<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> num_class<span class="token operator">=</span><span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token builtin">super</span><span class="token punctuation">(</span>FrequencyWeightedIntersectionOverUnion<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>num_class <span class="token operator">=</span> num_class    <span class="token keyword">def</span> <span class="token function">_generate_matrix</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> gt_image<span class="token punctuation">,</span> pre_image<span class="token punctuation">)</span><span class="token punctuation">:</span>        mask <span class="token operator">=</span> <span class="token punctuation">(</span>gt_image <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>gt_image <span class="token operator">&lt;</span> self<span class="token punctuation">.</span>num_class<span class="token punctuation">)</span>        label <span class="token operator">=</span> self<span class="token punctuation">.</span>num_class <span class="token operator">*</span> gt_image<span class="token punctuation">[</span>mask<span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">'int'</span><span class="token punctuation">)</span> <span class="token operator">+</span> pre_image<span class="token punctuation">[</span>mask<span class="token punctuation">]</span>        count <span class="token operator">=</span> np<span class="token punctuation">.</span>bincount<span class="token punctuation">(</span>label<span class="token punctuation">,</span> minlength<span class="token operator">=</span>self<span class="token punctuation">.</span>num_class<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span>        confusion_matrix <span class="token operator">=</span> count<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>self<span class="token punctuation">.</span>num_class<span class="token punctuation">,</span> self<span class="token punctuation">.</span>num_class<span class="token punctuation">)</span>        <span class="token keyword">return</span> confusion_matrix    <span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>inputs<span class="token punctuation">)</span><span class="token punctuation">:</span>        y_pred <span class="token operator">=</span> inputs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>asnumpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>        y <span class="token operator">=</span> inputs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>asnumpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">512</span><span class="token punctuation">,</span> <span class="token number">512</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>confusion_matrix <span class="token operator">+=</span> self<span class="token punctuation">.</span>_generate_matrix<span class="token punctuation">(</span>y<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">clear</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>confusion_matrix <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>num_class<span class="token punctuation">,</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">eval</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        freq <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>confusion_matrix<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>confusion_matrix<span class="token punctuation">)</span>        iu <span class="token operator">=</span> np<span class="token punctuation">.</span>diag<span class="token punctuation">(</span>self<span class="token punctuation">.</span>confusion_matrix<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>            np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>confusion_matrix<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>confusion_matrix<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">-</span>            np<span class="token punctuation">.</span>diag<span class="token punctuation">(</span>self<span class="token punctuation">.</span>confusion_matrix<span class="token punctuation">)</span><span class="token punctuation">)</span>        frequency_weighted_iou <span class="token operator">=</span> <span class="token punctuation">(</span>freq<span class="token punctuation">[</span>freq <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> iu<span class="token punctuation">[</span>freq <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> frequency_weighted_iou<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="æ¨¡å‹è®­ç»ƒ"><a href="#æ¨¡å‹è®­ç»ƒ" class="headerlink" title="æ¨¡å‹è®­ç»ƒ"></a>æ¨¡å‹è®­ç»ƒ</h2><p>å¯¼å…¥VGG-16é¢„è®­ç»ƒå‚æ•°åï¼Œå®ä¾‹åŒ–æŸå¤±å‡½æ•°ã€ä¼˜åŒ–å™¨ï¼Œä½¿ç”¨Modelæ¥å£ç¼–è¯‘ç½‘ç»œï¼Œè®­ç»ƒFCN-8sç½‘ç»œã€‚</p><blockquote><p>MindSpore GPUç‰ˆæœ¬åº•å±‚ä¾èµ–CUDNNï¼Œè€ŒCUDNNåœ¨é€‰æ‹©Conv2Då®ç°ç®—æ³•æ—¶ï¼Œé’ˆå¯¹ä¸åŒGPUç¡¬ä»¶é€‰æ‹©å‡ºçš„ç®—æ³•æ˜¾å­˜å ç”¨å·®å¼‚è¾ƒå¤§ã€‚è‹¥å‡ºç°æ˜¾å­˜ä¸å¤Ÿç”¨çš„æƒ…å†µï¼Œå¯ä»¥å°†ä¸‹é¢ä¸¤è¡Œä»£ç åŠ å…¥åˆ°è„šæœ¬çš„å¼€å§‹ä½ç½®ï¼Œæ­¤æ—¶ä¼šé€‰æ‹©æ˜¾å­˜æ¶ˆè€—æœ€å°çš„Conv2Dç®—æ³•å®ç°ã€‚</p><p>import os</p><p>os.environ[â€˜SET_CUDNN_CONV2D_ALGOâ€™] = â€˜trueâ€™</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> mindspore<span class="token keyword">from</span> mindspore <span class="token keyword">import</span> Tensor<span class="token keyword">import</span> mindspore<span class="token punctuation">.</span>nn <span class="token keyword">as</span> nn<span class="token keyword">from</span> mindspore<span class="token punctuation">.</span>train <span class="token keyword">import</span> ModelCheckpoint<span class="token punctuation">,</span> CheckpointConfig<span class="token punctuation">,</span> LossMonitor<span class="token punctuation">,</span> TimeMonitor<span class="token punctuation">,</span> Modeldevice_target <span class="token operator">=</span> <span class="token string">"GPU"</span>mindspore<span class="token punctuation">.</span>set_context<span class="token punctuation">(</span>mode<span class="token operator">=</span>mindspore<span class="token punctuation">.</span>PYNATIVE_MODE<span class="token punctuation">,</span> device_target<span class="token operator">=</span>device_target<span class="token punctuation">)</span>train_batch_size <span class="token operator">=</span> <span class="token number">4</span>num_classes <span class="token operator">=</span> <span class="token number">21</span><span class="token comment"># åˆå§‹åŒ–æ¨¡å‹ç»“æ„</span>net <span class="token operator">=</span> FCN8s<span class="token punctuation">(</span>n_class<span class="token operator">=</span><span class="token number">21</span><span class="token punctuation">)</span><span class="token comment"># å¯¼å…¥vgg16é¢„è®­ç»ƒå‚æ•°</span>load_vgg16<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># è®¡ç®—å­¦ä¹ ç‡</span>min_lr <span class="token operator">=</span> <span class="token number">0.0005</span>base_lr <span class="token operator">=</span> <span class="token number">0.05</span>train_epochs <span class="token operator">=</span> <span class="token number">1</span>iters_per_epoch <span class="token operator">=</span> dataset<span class="token punctuation">.</span>get_dataset_size<span class="token punctuation">(</span><span class="token punctuation">)</span>total_step <span class="token operator">=</span> iters_per_epoch <span class="token operator">*</span> train_epochslr_scheduler <span class="token operator">=</span> mindspore<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>cosine_decay_lr<span class="token punctuation">(</span>min_lr<span class="token punctuation">,</span>                                            base_lr<span class="token punctuation">,</span>                                            total_step<span class="token punctuation">,</span>                                            iters_per_epoch<span class="token punctuation">,</span>                                            decay_epoch<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>lr <span class="token operator">=</span> Tensor<span class="token punctuation">(</span>lr_scheduler<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment"># å®šä¹‰æŸå¤±å‡½æ•°</span>loss <span class="token operator">=</span> nn<span class="token punctuation">.</span>CrossEntropyLoss<span class="token punctuation">(</span>ignore_index<span class="token operator">=</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token comment"># å®šä¹‰ä¼˜åŒ–å™¨</span>optimizer <span class="token operator">=</span> nn<span class="token punctuation">.</span>Momentum<span class="token punctuation">(</span>params<span class="token operator">=</span>net<span class="token punctuation">.</span>trainable_params<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> learning_rate<span class="token operator">=</span>lr<span class="token punctuation">,</span> momentum<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span> weight_decay<span class="token operator">=</span><span class="token number">0.0001</span><span class="token punctuation">)</span><span class="token comment"># å®šä¹‰loss_scale</span>scale_factor <span class="token operator">=</span> <span class="token number">4</span>scale_window <span class="token operator">=</span> <span class="token number">3000</span>loss_scale_manager <span class="token operator">=</span> ms<span class="token punctuation">.</span>amp<span class="token punctuation">.</span>DynamicLossScaleManager<span class="token punctuation">(</span>scale_factor<span class="token punctuation">,</span> scale_window<span class="token punctuation">)</span><span class="token comment"># åˆå§‹åŒ–æ¨¡å‹</span><span class="token keyword">if</span> device_target <span class="token operator">==</span> <span class="token string">"Ascend"</span><span class="token punctuation">:</span>    model <span class="token operator">=</span> Model<span class="token punctuation">(</span>net<span class="token punctuation">,</span> loss_fn<span class="token operator">=</span>loss<span class="token punctuation">,</span> optimizer<span class="token operator">=</span>optimizer<span class="token punctuation">,</span> loss_scale_manager<span class="token operator">=</span>loss_scale_manager<span class="token punctuation">,</span> metrics<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"pixel accuracy"</span><span class="token punctuation">:</span> PixelAccuracy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"mean pixel accuracy"</span><span class="token punctuation">:</span> PixelAccuracyClass<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"mean IoU"</span><span class="token punctuation">:</span> MeanIntersectionOverUnion<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"frequency weighted IoU"</span><span class="token punctuation">:</span> FrequencyWeightedIntersectionOverUnion<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>    model <span class="token operator">=</span> Model<span class="token punctuation">(</span>net<span class="token punctuation">,</span> loss_fn<span class="token operator">=</span>loss<span class="token punctuation">,</span> optimizer<span class="token operator">=</span>optimizer<span class="token punctuation">,</span> metrics<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"pixel accuracy"</span><span class="token punctuation">:</span> PixelAccuracy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"mean pixel accuracy"</span><span class="token punctuation">:</span> PixelAccuracyClass<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"mean IoU"</span><span class="token punctuation">:</span> MeanIntersectionOverUnion<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"frequency weighted IoU"</span><span class="token punctuation">:</span> FrequencyWeightedIntersectionOverUnion<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token comment"># è®¾ç½®ckptæ–‡ä»¶ä¿å­˜çš„å‚æ•°</span>time_callback <span class="token operator">=</span> TimeMonitor<span class="token punctuation">(</span>data_size<span class="token operator">=</span>iters_per_epoch<span class="token punctuation">)</span>loss_callback <span class="token operator">=</span> LossMonitor<span class="token punctuation">(</span><span class="token punctuation">)</span>callbacks <span class="token operator">=</span> <span class="token punctuation">[</span>time_callback<span class="token punctuation">,</span> loss_callback<span class="token punctuation">]</span>save_steps <span class="token operator">=</span> <span class="token number">330</span>keep_checkpoint_max <span class="token operator">=</span> <span class="token number">5</span>config_ckpt <span class="token operator">=</span> CheckpointConfig<span class="token punctuation">(</span>save_checkpoint_steps<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span>                               keep_checkpoint_max<span class="token operator">=</span>keep_checkpoint_max<span class="token punctuation">)</span>ckpt_callback <span class="token operator">=</span> ModelCheckpoint<span class="token punctuation">(</span>prefix<span class="token operator">=</span><span class="token string">"FCN8s"</span><span class="token punctuation">,</span>                                directory<span class="token operator">=</span><span class="token string">"./ckpt"</span><span class="token punctuation">,</span>                                config<span class="token operator">=</span>config_ckpt<span class="token punctuation">)</span>callbacks<span class="token punctuation">.</span>append<span class="token punctuation">(</span>ckpt_callback<span class="token punctuation">)</span>model<span class="token punctuation">.</span>train<span class="token punctuation">(</span>train_epochs<span class="token punctuation">,</span> dataset<span class="token punctuation">,</span> callbacks<span class="token operator">=</span>callbacks<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>epoch: 1 step: 1, loss is 3.0904884338378906epoch: 1 step: 2, loss is 3.0506458282470703epoch: 1 step: 3, loss is 2.9796371459960938...                                        ...epoch: 1 step: 1141, loss is 1.3178229331970215epoch: 1 step: 1142, loss is 1.307207703590393epoch: 1 step: 1143, loss is 1.1257227659225464Train epoch time: 637526.089 ms, per step time: 557.766 ms</code></pre><blockquote><p>å› ä¸ºFCNç½‘ç»œåœ¨è®­ç»ƒçš„è¿‡ç¨‹ä¸­éœ€è¦å¤§é‡çš„è®­ç»ƒæ•°æ®å’Œè®­ç»ƒè½®æ•°ï¼Œè¿™é‡Œåªæä¾›äº†å°æ•°æ®å•ä¸ªepochçš„è®­ç»ƒæ¥æ¼”ç¤ºlossæ”¶æ•›çš„è¿‡ç¨‹ï¼Œä¸‹æ–‡ä¸­ä½¿ç”¨å·²è®­ç»ƒå¥½çš„æƒé‡æ–‡ä»¶è¿›è¡Œæ¨¡å‹è¯„ä¼°å’Œæ¨ç†æ•ˆæœçš„å±•ç¤ºã€‚</p></blockquote><h2 id="æ¨¡å‹è¯„ä¼°"><a href="#æ¨¡å‹è¯„ä¼°" class="headerlink" title="æ¨¡å‹è¯„ä¼°"></a>æ¨¡å‹è¯„ä¼°</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">IMAGE_MEAN <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">103.53</span><span class="token punctuation">,</span> <span class="token number">116.28</span><span class="token punctuation">,</span> <span class="token number">123.675</span><span class="token punctuation">]</span>IMAGE_STD <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">57.375</span><span class="token punctuation">,</span> <span class="token number">57.120</span><span class="token punctuation">,</span> <span class="token number">58.395</span><span class="token punctuation">]</span>DATA_FILE <span class="token operator">=</span> <span class="token string">"dataset/dataset_fcn8s/mindname.mindrecord"</span><span class="token comment"># ä¸‹è½½å·²è®­ç»ƒå¥½çš„æƒé‡æ–‡ä»¶</span>url <span class="token operator">=</span> <span class="token string">"https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/notebook/datasets/FCN8s.ckpt"</span>download<span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token string">"FCN8s.ckpt"</span><span class="token punctuation">,</span> replace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>net <span class="token operator">=</span> FCN8s<span class="token punctuation">(</span>n_class<span class="token operator">=</span>num_classes<span class="token punctuation">)</span>ckpt_file <span class="token operator">=</span> <span class="token string">"FCN8s.ckpt"</span>param_dict <span class="token operator">=</span> load_checkpoint<span class="token punctuation">(</span>ckpt_file<span class="token punctuation">)</span>load_param_into_net<span class="token punctuation">(</span>net<span class="token punctuation">,</span> param_dict<span class="token punctuation">)</span><span class="token keyword">if</span> device_target <span class="token operator">==</span> <span class="token string">"Ascend"</span><span class="token punctuation">:</span>    model <span class="token operator">=</span> Model<span class="token punctuation">(</span>net<span class="token punctuation">,</span> loss_fn<span class="token operator">=</span>loss<span class="token punctuation">,</span> optimizer<span class="token operator">=</span>optimizer<span class="token punctuation">,</span> loss_scale_manager<span class="token operator">=</span>loss_scale_manager<span class="token punctuation">,</span> metrics<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"pixel accuracy"</span><span class="token punctuation">:</span> PixelAccuracy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"mean pixel accuracy"</span><span class="token punctuation">:</span> PixelAccuracyClass<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"mean IoU"</span><span class="token punctuation">:</span> MeanIntersectionOverUnion<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"frequency weighted IoU"</span><span class="token punctuation">:</span> FrequencyWeightedIntersectionOverUnion<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>    model <span class="token operator">=</span> Model<span class="token punctuation">(</span>net<span class="token punctuation">,</span> loss_fn<span class="token operator">=</span>loss<span class="token punctuation">,</span> optimizer<span class="token operator">=</span>optimizer<span class="token punctuation">,</span> metrics<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"pixel accuracy"</span><span class="token punctuation">:</span> PixelAccuracy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"mean pixel accuracy"</span><span class="token punctuation">:</span> PixelAccuracyClass<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"mean IoU"</span><span class="token punctuation">:</span> MeanIntersectionOverUnion<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"frequency weighted IoU"</span><span class="token punctuation">:</span> FrequencyWeightedIntersectionOverUnion<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token comment"># å®ä¾‹åŒ–Dataset</span>dataset <span class="token operator">=</span> SegDataset<span class="token punctuation">(</span>image_mean<span class="token operator">=</span>IMAGE_MEAN<span class="token punctuation">,</span>                     image_std<span class="token operator">=</span>IMAGE_STD<span class="token punctuation">,</span>                     data_file<span class="token operator">=</span>DATA_FILE<span class="token punctuation">,</span>                     batch_size<span class="token operator">=</span>train_batch_size<span class="token punctuation">,</span>                     crop_size<span class="token operator">=</span>crop_size<span class="token punctuation">,</span>                     max_scale<span class="token operator">=</span>max_scale<span class="token punctuation">,</span>                     min_scale<span class="token operator">=</span>min_scale<span class="token punctuation">,</span>                     ignore_label<span class="token operator">=</span>ignore_label<span class="token punctuation">,</span>                     num_classes<span class="token operator">=</span>num_classes<span class="token punctuation">,</span>                     num_readers<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>                     num_parallel_calls<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span>dataset_eval <span class="token operator">=</span> dataset<span class="token punctuation">.</span>get_dataset<span class="token punctuation">(</span><span class="token punctuation">)</span>model<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span>dataset_eval<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>{'pixel accuracy': 0.9734971889839162, 'mean pixel accuracy': 0.9417477500248013, 'mean IoU': 0.8956981094249392, 'frequency weighted IoU': 0.9488965587686847}</code></pre><h2 id="æ¨¡å‹æ¨ç†"><a href="#æ¨¡å‹æ¨ç†" class="headerlink" title="æ¨¡å‹æ¨ç†"></a>æ¨¡å‹æ¨ç†</h2><p>ä½¿ç”¨è®­ç»ƒçš„ç½‘ç»œå¯¹æ¨¡å‹æ¨ç†ç»“æœè¿›è¡Œå±•ç¤ºã€‚</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> cv2<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> pltnet <span class="token operator">=</span> FCN8s<span class="token punctuation">(</span>n_class<span class="token operator">=</span>num_classes<span class="token punctuation">)</span><span class="token comment"># è®¾ç½®è¶…å‚</span>ckpt_file <span class="token operator">=</span> <span class="token string">"FCN8s.ckpt"</span>param_dict <span class="token operator">=</span> load_checkpoint<span class="token punctuation">(</span>ckpt_file<span class="token punctuation">)</span>load_param_into_net<span class="token punctuation">(</span>net<span class="token punctuation">,</span> param_dict<span class="token punctuation">)</span>eval_batch_size <span class="token operator">=</span> <span class="token number">4</span>img_lst <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>mask_lst <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>res_lst <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token comment"># æ¨ç†æ•ˆæœå±•ç¤º(ä¸Šæ–¹ä¸ºè¾“å…¥å›¾ç‰‡ï¼Œä¸‹æ–¹ä¸ºæ¨ç†æ•ˆæœå›¾ç‰‡)</span>plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>show_data <span class="token operator">=</span> <span class="token builtin">next</span><span class="token punctuation">(</span>dataset_eval<span class="token punctuation">.</span>create_dict_iterator<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>show_images <span class="token operator">=</span> show_data<span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>asnumpy<span class="token punctuation">(</span><span class="token punctuation">)</span>mask_images <span class="token operator">=</span> show_data<span class="token punctuation">[</span><span class="token string">"label"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">512</span><span class="token punctuation">,</span> <span class="token number">512</span><span class="token punctuation">]</span><span class="token punctuation">)</span>show_images <span class="token operator">=</span> np<span class="token punctuation">.</span>clip<span class="token punctuation">(</span>show_images<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>eval_batch_size<span class="token punctuation">)</span><span class="token punctuation">:</span>    img_lst<span class="token punctuation">.</span>append<span class="token punctuation">(</span>show_images<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>    mask_lst<span class="token punctuation">.</span>append<span class="token punctuation">(</span>mask_images<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>res <span class="token operator">=</span> net<span class="token punctuation">(</span>show_data<span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>asnumpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>eval_batch_size<span class="token punctuation">)</span><span class="token punctuation">:</span>    plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>img_lst<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>transpose<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">"off"</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>subplots_adjust<span class="token punctuation">(</span>wspace<span class="token operator">=</span><span class="token number">0.05</span><span class="token punctuation">,</span> hspace<span class="token operator">=</span><span class="token number">0.02</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>res<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">"off"</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>subplots_adjust<span class="token punctuation">(</span>wspace<span class="token operator">=</span><span class="token number">0.05</span><span class="token punctuation">,</span> hspace<span class="token operator">=</span><span class="token number">0.02</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹<br><img src="https://niubi-1316733611.cos.ap-beijing.myqcloud.com/mindspore_fcn8s_21_0.png" alt="png"><br>â€‹    </p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>FCNçš„æ ¸å¿ƒè´¡çŒ®åœ¨äºæå‡ºä½¿ç”¨å…¨å·ç§¯å±‚ï¼Œé€šè¿‡å­¦ä¹ è®©å›¾ç‰‡å®ç°ç«¯åˆ°ç«¯åˆ†å‰²ã€‚ä¸ä¼ ç»Ÿä½¿ç”¨CNNè¿›è¡Œå›¾åƒåˆ†å‰²çš„æ–¹æ³•ç›¸æ¯”ï¼ŒFCNæœ‰ä¸¤å¤§æ˜æ˜¾çš„ä¼˜ç‚¹ï¼šä¸€æ˜¯å¯ä»¥æ¥å—ä»»æ„å¤§å°çš„è¾“å…¥å›¾åƒï¼Œæ— éœ€è¦æ±‚æ‰€æœ‰çš„è®­ç»ƒå›¾åƒå’Œæµ‹è¯•å›¾åƒå…·æœ‰å›ºå®šçš„å°ºå¯¸ã€‚äºŒæ˜¯æ›´åŠ é«˜æ•ˆï¼Œé¿å…äº†ç”±äºä½¿ç”¨åƒç´ å—è€Œå¸¦æ¥çš„é‡å¤å­˜å‚¨å’Œè®¡ç®—å·ç§¯çš„é—®é¢˜ã€‚</p><p>åŒæ—¶FCNç½‘ç»œä¹Ÿå­˜åœ¨å¾…æ”¹è¿›ä¹‹å¤„ï¼š</p><p>ä¸€æ˜¯å¾—åˆ°çš„ç»“æœä»ä¸å¤Ÿç²¾ç»†ã€‚è¿›è¡Œ8å€ä¸Šé‡‡æ ·è™½ç„¶æ¯”32å€çš„æ•ˆæœå¥½äº†å¾ˆå¤šï¼Œä½†æ˜¯ä¸Šé‡‡æ ·çš„ç»“æœä»æ¯”è¾ƒæ¨¡ç³Šå’Œå¹³æ»‘ï¼Œå°¤å…¶æ˜¯è¾¹ç•Œå¤„ï¼Œç½‘ç»œå¯¹å›¾åƒä¸­çš„ç»†èŠ‚ä¸æ•æ„Ÿã€‚<br>äºŒæ˜¯å¯¹å„ä¸ªåƒç´ è¿›è¡Œåˆ†ç±»ï¼Œæ²¡æœ‰å……åˆ†è€ƒè™‘åƒç´ ä¸åƒç´ ä¹‹é—´çš„å…³ç³»ï¼ˆå¦‚ä¸è¿ç»­æ€§å’Œç›¸ä¼¼æ€§ï¼‰ã€‚å¿½ç•¥äº†åœ¨é€šå¸¸çš„åŸºäºåƒç´ åˆ†ç±»çš„åˆ†å‰²æ–¹æ³•ä¸­ä½¿ç”¨çš„ç©ºé—´è§„æ•´ï¼ˆspatial regularizationï¼‰æ­¥éª¤ï¼Œç¼ºä¹ç©ºé—´ä¸€è‡´æ€§ã€‚</p><h2 id="å¼•ç”¨"><a href="#å¼•ç”¨" class="headerlink" title="å¼•ç”¨"></a>å¼•ç”¨</h2><p>[1]Long, Jonathan, Evan Shelhamer, and Trevor Darrell. â€œFully convolutional networks for Semantic Segmentation.â€ Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition. 2015.</p>]]></content>
      
      
      <categories>
          
          <category> é¡¹ç›® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> FCN </tag>
            
            <tag> MindSpore </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ç¯‡åšå®¢</title>
      <link href="/2023/07/25/hello-world/"/>
      <url>/2023/07/25/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo new <span class="token string">"My New Post"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo server<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo generate<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo deploy<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ã€æ´»åŠ¨å›é¡¾ã€‘ä¸‡ç»´å¹»å¢ƒè‰ºæœ¯å±•-æ²ˆé˜³æ˜Ÿéƒ¨è½</title>
      <link href="/2023/07/24/untitled/"/>
      <url>/2023/07/24/untitled/</url>
      
        <content type="html"><![CDATA[<p style="text-align: center;">    <strong><span style="font-size: 18px;">è°èƒ½æ‹’ç»åœ¨é—²æš‡çš„å‡æœŸé‡Œ<br>çœ‹ä¸€åœºå±•è§ˆå‘¢<br>ï¼Ÿï¼Ÿï¼Ÿ<br>å¿«å¿«è·Ÿéšæ²ˆé˜³æ˜Ÿéƒ¨è½çš„å°ä¼™ä¼´ä»¬<br>ä¸€èµ·èµ°è¿›</span></strong><span style="text-decoration: underline;"><strong><span style="text-decoration: underline; font-size: 18px;">ä¸‡ç»´å¹»å¢ƒè‰ºæœ¯å±•</span></strong></span><strong><span style="font-size: 18px;">å§<br>ï¼ˆè¯è¯´æˆ‘ä»æ¥æ²¡èŠ±é’±çœ‹è¿‡å±•è§ˆå‘¢ï¼‰</span><img src="http://www.samsungmembers.cn//ueditor/dialogs/emotion/images/yellow/17.gif" width="30px" height="30px"><span style="font-size: 18px;"><br>æ„Ÿè°¢ç›–ä¹ä¸–ç¤¾åŒºæä¾›è¿™ä¹ˆå¥½çš„æœºä¼š</span><img src="http://www.samsungmembers.cn//ueditor/dialogs/emotion/images/yellow/45.gif" width="30px" height="30px"><span style="font-size: 18px;"><br><br>è¢«æ”¾åœ¨å®£ä¼ ç”»ä¸Šé¢çš„ä½œå“ï¼Œå®ç‰©çœ‹èµ·æ¥æ›´æƒŠè‰³å‘¢<br></span><img src="http://www.galaxyclub.cn//Upload/IMAGES/23/0724/3fd5bbadb415453b9a0116de6c4412ef_650x0.jpeg" class="ueditor_img" alt="" id="img16901662635220"><span style="font-size: 18px;">ä¸€äº›å…³äºå±•è§ˆçš„ä»‹ç»</span><img src="http://www.galaxyclub.cn//Upload/IMAGES/23/0724/5d0033245be94ad0b8567872527a5a14_650x0.jpeg" class="ueditor_img" alt="" id="img16901662635231"><span style="font-size: 18px;">å¥‡å¥‡æ€ªæ€ªçš„çš„ï¼Œæˆ–è®¸è¿™å°±æ˜¯è‰ºæœ¯å§</span><img src="http://www.samsungmembers.cn//ueditor/dialogs/emotion/images/life/20.gif" width="30px" height="30px"><img src="http://www.galaxyclub.cn//Upload/IMAGES/23/0724/9e126effd8cd46cdb336652a631e0861_650x0.jpeg" class="ueditor_img" alt="" id="img16901662635232"><span style="font-size: 18px;">ç«çƒˆé¸Ÿå’Œå¤§é»„é¸­çš„é€ å‹ï¼Œé…åˆå¼¹ç°§ä¸€æ ·çš„æ„é€ ï¼Œå‘äººä»¬å±•ç¤ºå‡ºä½œè€…å†…å¿ƒâ€¦â€¦ï¼ˆç¼–ä¸ä¸‹å»äº†ï¼‰</span><img src="http://www.galaxyclub.cn//Upload/IMAGES/23/0724/aee220e6fdb34709a25fb3ae22a2fcec_650x0.jpeg" class="ueditor_img" alt="" id="img16901667157420"><span style="font-size: 18px;">è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªåœ†å½¢å’Œæ–¹å½¢å…ƒç´ æ„æˆçš„ç¯®çƒåœºï¼Œè¿˜æœ‰ä¸¤ä¸ªæµ·ç»µæè´¨çš„ç¯®çƒï¼Œè›®å¥½ç©çš„</span><img src="http://www.galaxyclub.cn//Upload/IMAGES/23/0724/bc1313a037ea4890a6d79b58f8fbc9b2_650x0.jpeg" class="ueditor_img" alt="" id="img16901667157421"><span style="font-size: 18px;">æˆ‘çˆ±é’±ï¼Œé’±çˆ±æˆ‘</span><img src="http://www.samsungmembers.cn//ueditor/dialogs/emotion/images/life/19.gif" width="30px" height="30px"><img src="http://www.galaxyclub.cn//Upload/IMAGES/23/0724/638e38706aa749a183bd26f1a39c0d55_650x0.jpeg" class="ueditor_img" alt="" id="img16901662635233"><span style="font-size: 18px;">ä¸´è¿‘å‡ºå£è¿˜æœ‰ä¸€é¢å¢™ç”¨äºäº’åŠ¨</span><img src="http://www.galaxyclub.cn//Upload/IMAGES/23/0724/92db0a1d25494898b0e75e6a3bd77963_650x0.jpeg" class="ueditor_img" alt="" id="img16901662635234"><span style="font-size: 18px;">å·å·å·æ‹ä¸€ä¸‹åŒè¡Œçš„å°ä¼™ä¼´ä»¬å§</span><img src="http://www.galaxyclub.cn//Upload/IMAGES/23/0724/7388864f62204ba7b22d8d0c0361d5bf_650x0.jpeg" class="ueditor_img" alt="" id="img16901662635235"><span style="font-size: 18px;">å…¥å£å¤„çš„ä¸€äº›çºªå¿µå“</span><img src="http://www.galaxyclub.cn//Upload/IMAGES/23/0724/f42dc6e5d1ce484b97940bbb247f99e3_650x0.jpeg" class="ueditor_img" alt="" id="img16901662635236"><span style="font-size: 18px;"><br>æœ¬æ¬¡æ´»åŠ¨çš„ä¼´æ‰‹ç¤¼ï¼Œå¾ˆä¸°å¯Œå•Š</span><img src="http://www.galaxyclub.cn//Upload/IMAGES/23/0724/90db9bd45fb14b31bad8dbad58549f0b_650x0.jpeg" class="ueditor_img" alt="" id="img16901665718760"><span style="font-size: 18px;">æœ€åé™„ä¸Šå¤§åˆå½±ï¼Œå¼€å¿ƒå›å®¶</span><img src="http://www.samsungmembers.cn//ueditor/dialogs/emotion/images/life/23.gif" width="30px" height="30px"><img src="http://www.galaxyclub.cn//Upload/IMAGES/23/0724/575a978cf18a4ef0b85af42e6b932940_650x0.jpeg" class="ueditor_img" alt="" id="img16901662635237"></strong></p>]]></content>
      
      
      <categories>
          
          <category> ç”Ÿæ´» </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç›–ä¹ä¸–ç¤¾åŒº </tag>
            
            <tag> æ²ˆé˜³æ˜Ÿéƒ¨è½ </tag>
            
            <tag> ä¸‰æ˜Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
